[0m10:45:45.357697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fd690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107436e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074379d0>]}


============================== 10:45:45.360234 | 5c8fa128-bcfa-434b-a719-5de82c5fbb97 ==============================
[0m10:45:45.360234 [info ] [MainThread]: Running with dbt=1.7.1
[0m10:45:45.360543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:45:45.360858 [info ] [MainThread]: dbt version: 1.7.1
[0m10:45:45.361017 [info ] [MainThread]: python version: 3.11.10
[0m10:45:45.361171 [info ] [MainThread]: python path: /Users/rachelgao/Desktop/personal-projects/dbt-course/venv/bin/python
[0m10:45:45.361310 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m10:45:45.480317 [info ] [MainThread]: Using profiles dir at /Users/rachelgao/.dbt
[0m10:45:45.480559 [info ] [MainThread]: Using profiles.yml file at /Users/rachelgao/.dbt/profiles.yml
[0m10:45:45.480720 [info ] [MainThread]: Using dbt_project.yml file at /Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/dbt_project.yml
[0m10:45:45.480990 [info ] [MainThread]: adapter type: snowflake
[0m10:45:45.481170 [info ] [MainThread]: adapter version: 1.7.1
[0m10:45:45.509140 [info ] [MainThread]: Configuration:
[0m10:45:45.509377 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:45:45.509549 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:45:45.509689 [info ] [MainThread]: Required dependencies:
[0m10:45:45.509858 [debug] [MainThread]: Executing "git --help"
[0m10:45:45.520622 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:45:45.521105 [debug] [MainThread]: STDERR: "b''"
[0m10:45:45.521270 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:45:45.521420 [info ] [MainThread]: Connection:
[0m10:45:45.521606 [info ] [MainThread]:   account: ubnyzrz-kb52270
[0m10:45:45.521724 [info ] [MainThread]:   user: dbt
[0m10:45:45.521840 [info ] [MainThread]:   database: AIRBNB
[0m10:45:45.521952 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:45:45.522067 [info ] [MainThread]:   role: transform
[0m10:45:45.522181 [info ] [MainThread]:   schema: DEV
[0m10:45:45.522294 [info ] [MainThread]:   authenticator: None
[0m10:45:45.522408 [info ] [MainThread]:   private_key_path: None
[0m10:45:45.522517 [info ] [MainThread]:   token: None
[0m10:45:45.522626 [info ] [MainThread]:   oauth_client_id: None
[0m10:45:45.522738 [info ] [MainThread]:   query_tag: None
[0m10:45:45.522847 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:45:45.522959 [info ] [MainThread]:   host: None
[0m10:45:45.523070 [info ] [MainThread]:   port: None
[0m10:45:45.523178 [info ] [MainThread]:   proxy_host: None
[0m10:45:45.523285 [info ] [MainThread]:   proxy_port: None
[0m10:45:45.523394 [info ] [MainThread]:   protocol: None
[0m10:45:45.523506 [info ] [MainThread]:   connect_retries: 1
[0m10:45:45.523615 [info ] [MainThread]:   connect_timeout: None
[0m10:45:45.523723 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:45:45.523833 [info ] [MainThread]:   retry_all: False
[0m10:45:45.523958 [info ] [MainThread]:   insecure_mode: False
[0m10:45:45.524084 [info ] [MainThread]:   reuse_connections: None
[0m10:45:45.524279 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m10:45:45.527414 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:45:45.528374 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:45:45.528618 [debug] [MainThread]: On debug: select 1 as id
[0m10:45:45.528776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:45:46.066967 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m10:45:46.069724 [debug] [MainThread]: On debug: Close
[0m10:45:46.121069 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:45:46.121467 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:45:46.124580 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.80106443, "process_user_time": 0.914173, "process_kernel_time": 0.138449, "process_mem_max_rss": "133251072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:45:46.125011 [debug] [MainThread]: Command `dbt debug` succeeded at 10:45:46.124931 after 0.80 seconds
[0m10:45:46.125243 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:45:46.125451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f0b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eaf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ef1f50>]}
[0m10:45:46.125673 [debug] [MainThread]: Flushing usage events
[0m11:55:37.190825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1d0d0>]}


============================== 11:55:37.193576 | 0796b8e1-07d4-4d78-a64d-555de354edc5 ==============================
[0m11:55:37.193576 [info ] [MainThread]: Running with dbt=1.7.1
[0m11:55:37.193898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:55:37.352820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0796b8e1-07d4-4d78-a64d-555de354edc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062af850>]}
[0m11:55:37.388187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0796b8e1-07d4-4d78-a64d-555de354edc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dac90>]}
[0m11:55:37.388853 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:55:37.397620 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m11:55:37.420376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:37.420650 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:37.423686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0796b8e1-07d4-4d78-a64d-555de354edc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062af690>]}
[0m11:55:37.429058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0796b8e1-07d4-4d78-a64d-555de354edc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af5f90>]}
[0m11:55:37.429303 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m11:55:37.429488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0796b8e1-07d4-4d78-a64d-555de354edc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10528a710>]}
[0m11:55:37.430333 [info ] [MainThread]: 
[0m11:55:37.430718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:55:37.431257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:55:37.437078 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:55:37.437255 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:55:37.437400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:37.920877 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m11:55:37.923719 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:55:37.975378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m11:55:37.976937 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m11:55:37.982757 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m11:55:37.983173 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m11:55:37.983506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:38.218791 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:38.228484 [debug] [ThreadPool]: On create_AIRBNB_DEV: Close
[0m11:55:38.281728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m11:55:38.291137 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m11:55:38.291713 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m11:55:38.292224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:38.476635 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:55:38.479801 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m11:55:38.527865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0796b8e1-07d4-4d78-a64d-555de354edc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106741d90>]}
[0m11:55:38.529334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:38.530096 [info ] [MainThread]: 
[0m11:55:38.533865 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m11:55:38.534558 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_listings ................................... [RUN]
[0m11:55:38.535371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_listings)
[0m11:55:38.535735 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m11:55:38.542536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m11:55:38.543785 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 11:55:38.535963 => 11:55:38.543483
[0m11:55:38.544271 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m11:55:38.566751 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m11:55:38.568115 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m11:55:38.568409 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m11:55:38.568641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:39.002458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:39.023210 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 11:55:38.544486 => 11:55:39.022970
[0m11:55:39.024017 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m11:55:39.070567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0796b8e1-07d4-4d78-a64d-555de354edc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f51d0>]}
[0m11:55:39.071274 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.54s]
[0m11:55:39.071882 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m11:55:39.073868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:39.074172 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was properly closed.
[0m11:55:39.074492 [info ] [MainThread]: 
[0m11:55:39.074780 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m11:55:39.075313 [debug] [MainThread]: Command end result
[0m11:55:39.084927 [info ] [MainThread]: 
[0m11:55:39.085440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:39.085751 [info ] [MainThread]: 
[0m11:55:39.086011 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:55:39.088266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9252888, "process_user_time": 1.256103, "process_kernel_time": 0.18842, "process_mem_max_rss": "145637376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m11:55:39.088957 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:39.088826 after 1.93 seconds
[0m11:55:39.089307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100963550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105289e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100949f50>]}
[0m11:55:39.089621 [debug] [MainThread]: Flushing usage events
[0m12:01:43.706031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da1d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105470ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054719d0>]}


============================== 12:01:43.708755 | d9c6597e-c74f-4008-87f4-fd26e9ab2671 ==============================
[0m12:01:43.708755 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:01:43.709067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:43.864074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6d350>]}
[0m12:01:43.896063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a54d0>]}
[0m12:01:43.896449 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:01:43.903793 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:01:43.918666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:43.918865 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:43.921536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3f610>]}
[0m12:01:43.926554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d55010>]}
[0m12:01:43.926787 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m12:01:43.926966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8bd10>]}
[0m12:01:43.927840 [info ] [MainThread]: 
[0m12:01:43.928217 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:01:43.928805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:01:43.934607 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:01:43.934770 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:01:43.934908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:44.374892 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:01:44.377398 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:01:44.430533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:01:44.440870 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:01:44.441412 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m12:01:44.441713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:44.811060 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:01:44.814575 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:01:44.879545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104762090>]}
[0m12:01:44.880872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:44.881301 [info ] [MainThread]: 
[0m12:01:44.885290 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:01:44.886013 [info ] [Thread-1 (]: 1 of 2 START sql view model DEV.src_listings ................................... [RUN]
[0m12:01:44.886870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_listings)
[0m12:01:44.887215 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:01:44.893444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:01:44.894374 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 12:01:44.887405 => 12:01:44.894176
[0m12:01:44.894703 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:01:44.914320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:01:44.915194 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:01:44.915478 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m12:01:44.915719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:45.213350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:01:45.236836 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 12:01:44.894890 => 12:01:45.236619
[0m12:01:45.237343 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:01:45.308518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d6710>]}
[0m12:01:45.309544 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.42s]
[0m12:01:45.310219 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:01:45.310665 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:01:45.311236 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:01:45.312020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:01:45.312400 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:01:45.314334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:01:45.315275 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 12:01:45.312623 => 12:01:45.315065
[0m12:01:45.315623 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:01:45.318783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:01:45.319743 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:01:45.320059 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m12:01:45.320364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:45.936183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:01:45.942392 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 12:01:45.315804 => 12:01:45.942184
[0m12:01:45.942869 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:01:45.986965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9c6597e-c74f-4008-87f4-fd26e9ab2671', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbbc90>]}
[0m12:01:45.987698 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.68s]
[0m12:01:45.988365 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:01:45.990148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:45.990507 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m12:01:45.990832 [info ] [MainThread]: 
[0m12:01:45.991131 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m12:01:45.991762 [debug] [MainThread]: Command end result
[0m12:01:46.000064 [info ] [MainThread]: 
[0m12:01:46.000355 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:46.000575 [info ] [MainThread]: 
[0m12:01:46.000811 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:01:46.002883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3238182, "process_user_time": 1.214291, "process_kernel_time": 0.16874, "process_mem_max_rss": "140296192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:01:46.003392 [debug] [MainThread]: Command `dbt run` succeeded at 12:01:46.003290 after 2.32 seconds
[0m12:01:46.003707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f23550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100f09f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101092110>]}
[0m12:01:46.004015 [debug] [MainThread]: Flushing usage events
[0m12:20:58.007165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10662fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c1450>]}


============================== 12:20:58.009735 | 748d9a3f-8c78-446c-a92b-e689ecba4b85 ==============================
[0m12:20:58.009735 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:20:58.010045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:20:58.160057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073da910>]}
[0m12:20:58.191964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c86a10>]}
[0m12:20:58.192336 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:20:58.200917 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:20:58.241953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:20:58.242223 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:20:58.245082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abd9d0>]}
[0m12:20:58.250189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c48cd0>]}
[0m12:20:58.250388 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m12:20:58.250561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdd450>]}
[0m12:20:58.251422 [info ] [MainThread]: 
[0m12:20:58.251773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:58.252326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:20:58.258261 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:20:58.258434 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:20:58.258589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:58.776929 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:20:58.780468 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:20:58.896661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:20:58.906985 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:20:58.907401 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m12:20:58.907725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:59.217088 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:20:59.220458 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:20:59.298393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6dad0>]}
[0m12:20:59.300312 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:59.300998 [info ] [MainThread]: 
[0m12:20:59.304228 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:20:59.304705 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:20:59.305405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:20:59.305756 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:20:59.312974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:20:59.314500 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 12:20:59.305989 => 12:20:59.314214
[0m12:20:59.314911 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:20:59.335948 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:20:59.336675 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:20:59.336915 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m12:20:59.337152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:59.807959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:20:59.828610 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 12:20:59.315150 => 12:20:59.828394
[0m12:20:59.829079 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:20:59.944117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808a110>]}
[0m12:20:59.945277 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.64s]
[0m12:20:59.946410 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:20:59.947021 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:20:59.947715 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listings ................................... [RUN]
[0m12:20:59.948606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:20:59.949009 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:20:59.951412 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:20:59.952340 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 12:20:59.949247 => 12:20:59.952112
[0m12:20:59.952702 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:20:59.956286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:20:59.957478 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:20:59.958031 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m12:20:59.958391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:00.342628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:21:00.350983 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 12:20:59.952920 => 12:21:00.350686
[0m12:21:00.351528 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:21:00.403526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cda10>]}
[0m12:21:00.404423 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.46s]
[0m12:21:00.405177 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:21:00.405703 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:21:00.406347 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:21:00.407128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:21:00.407484 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:21:00.409744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:21:00.410715 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 12:21:00.407698 => 12:21:00.410496
[0m12:21:00.411057 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:21:00.416068 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:21:00.417003 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:21:00.417321 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m12:21:00.417622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:21:00.767647 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:21:00.772443 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 12:21:00.411263 => 12:21:00.772113
[0m12:21:00.773494 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:21:00.829449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748d9a3f-8c78-446c-a92b-e689ecba4b85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081b5a10>]}
[0m12:21:00.830288 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.42s]
[0m12:21:00.830977 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:21:00.832922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:00.833254 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was properly closed.
[0m12:21:00.833606 [info ] [MainThread]: 
[0m12:21:00.833939 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m12:21:00.834774 [debug] [MainThread]: Command end result
[0m12:21:00.843182 [info ] [MainThread]: 
[0m12:21:00.843573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:00.843857 [info ] [MainThread]: 
[0m12:21:00.844150 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:21:00.848068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8666809, "process_user_time": 1.279364, "process_kernel_time": 0.180373, "process_mem_max_rss": "139968512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:21:00.848715 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:00.848604 after 2.87 seconds
[0m12:21:00.849042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e73550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe1fd0>]}
[0m12:21:00.849327 [debug] [MainThread]: Flushing usage events
[0m12:27:40.285252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10537b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465ba50>]}


============================== 12:27:40.288276 | dbabd589-ee16-4131-b5a4-815dd1fff4fd ==============================
[0m12:27:40.288276 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:27:40.288610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:27:40.455897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c7690>]}
[0m12:27:40.489566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539add0>]}
[0m12:27:40.490060 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:27:40.499636 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:27:40.524222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:27:40.524451 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:27:40.527306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b83d0>]}
[0m12:27:40.534020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c86290>]}
[0m12:27:40.534241 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m12:27:40.534417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c7590>]}
[0m12:27:40.535313 [info ] [MainThread]: 
[0m12:27:40.535687 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:27:40.536293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:27:40.542091 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:27:40.542258 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:27:40.542405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:27:40.994531 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:27:40.997787 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:27:41.062204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:27:41.071874 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:27:41.072399 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m12:27:41.072783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:27:41.421091 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:27:41.424001 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:27:41.497199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105411610>]}
[0m12:27:41.498586 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:27:41.499330 [info ] [MainThread]: 
[0m12:27:41.503460 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:27:41.503927 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:27:41.504536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:27:41.504820 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:27:41.510181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:27:41.511431 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 12:27:41.505016 => 12:27:41.511256
[0m12:27:41.511735 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:27:41.534653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:27:41.535755 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:27:41.536009 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m12:27:41.536225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:41.999206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:27:42.024217 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 12:27:41.511922 => 12:27:42.023927
[0m12:27:42.024714 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:27:42.070076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0f350>]}
[0m12:27:42.070969 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.57s]
[0m12:27:42.071499 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:27:42.071865 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:27:42.072486 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listings ................................... [RUN]
[0m12:27:42.073309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:27:42.073646 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:27:42.075344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:27:42.076670 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 12:27:42.073849 => 12:27:42.076426
[0m12:27:42.077003 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:27:42.080483 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:27:42.081664 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:27:42.081997 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m12:27:42.082289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:42.355102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:27:42.359943 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 12:27:42.077193 => 12:27:42.359679
[0m12:27:42.360719 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:27:42.409229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e30950>]}
[0m12:27:42.410373 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.34s]
[0m12:27:42.411107 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:27:42.411557 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:27:42.412223 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:27:42.413036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:27:42.413418 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:27:42.415326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:27:42.417328 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 12:27:42.413646 => 12:27:42.417092
[0m12:27:42.417708 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:27:42.423482 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:27:42.424906 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:27:42.425350 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m12:27:42.425683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:42.715578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:27:42.719858 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 12:27:42.417931 => 12:27:42.719592
[0m12:27:42.720427 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:27:42.768844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611fb90>]}
[0m12:27:42.770593 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.36s]
[0m12:27:42.771529 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:27:42.772031 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:27:42.772640 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m12:27:42.773482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_listings_cleansed)
[0m12:27:42.773872 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:27:42.777263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:27:42.778209 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 12:27:42.774114 => 12:27:42.777996
[0m12:27:42.778579 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:27:42.782835 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:27:42.784461 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:27:42.784840 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
  );
[0m12:27:42.785164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:27:43.067095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:27:43.072238 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 12:27:42.778952 => 12:27:43.071917
[0m12:27:43.072915 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:27:43.118995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbabd589-ee16-4131-b5a4-815dd1fff4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e89a50>]}
[0m12:27:43.120242 [info ] [Thread-1 (]: 4 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.35s]
[0m12:27:43.121121 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:27:43.123687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:27:43.124114 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m12:27:43.124519 [info ] [MainThread]: 
[0m12:27:43.124849 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m12:27:43.125595 [debug] [MainThread]: Command end result
[0m12:27:43.133840 [info ] [MainThread]: 
[0m12:27:43.134206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:27:43.134480 [info ] [MainThread]: 
[0m12:27:43.134755 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:27:43.136857 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8811877, "process_user_time": 1.436232, "process_kernel_time": 0.219918, "process_mem_max_rss": "140607488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:27:43.137331 [debug] [MainThread]: Command `dbt run` succeeded at 12:27:43.137229 after 2.88 seconds
[0m12:27:43.137654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e9f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1e190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ad0a50>]}
[0m12:27:43.137964 [debug] [MainThread]: Flushing usage events
[0m12:35:16.869389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109aecd0>]}


============================== 12:35:16.872351 | 677491cc-274d-4e0f-ae20-30fe39402d64 ==============================
[0m12:35:16.872351 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:35:16.872666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:35:17.034366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ce3c10>]}
[0m12:35:17.070699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a29cd0>]}
[0m12:35:17.071266 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:35:17.081236 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:35:17.116318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:35:17.116606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:35:17.119838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f6bd0>]}
[0m12:35:17.127318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d9c90>]}
[0m12:35:17.127563 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m12:35:17.127748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532da50>]}
[0m12:35:17.128720 [info ] [MainThread]: 
[0m12:35:17.129120 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:17.129734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:35:17.135806 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:35:17.136067 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:35:17.136223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:17.526423 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:35:17.529203 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:35:17.594515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:35:17.604640 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:35:17.605209 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m12:35:17.605632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:17.988912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:35:17.993094 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:35:18.047444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f85110>]}
[0m12:35:18.049045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:18.049582 [info ] [MainThread]: 
[0m12:35:18.052483 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:35:18.053134 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:35:18.053943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:35:18.054319 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:35:18.061078 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:35:18.062870 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 12:35:18.054544 => 12:35:18.062644
[0m12:35:18.063226 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:35:18.085289 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:35:18.086580 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:35:18.086843 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m12:35:18.087281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:18.647025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:35:18.672610 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 12:35:18.063411 => 12:35:18.672418
[0m12:35:18.673054 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:35:18.725851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11281dfd0>]}
[0m12:35:18.726589 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.67s]
[0m12:35:18.727139 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:35:18.727512 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:35:18.728232 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m12:35:18.729164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:35:18.729564 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:35:18.731358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:35:18.733313 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 12:35:18.729786 => 12:35:18.732987
[0m12:35:18.733723 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:35:18.737174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:35:18.738311 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:35:18.738619 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m12:35:18.738901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:19.043566 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:19.049369 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 12:35:18.733923 => 12:35:19.049171
[0m12:35:19.049776 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:35:19.099270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128da3d0>]}
[0m12:35:19.100789 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.37s]
[0m12:35:19.101426 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:35:19.101824 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:35:19.102455 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:35:19.103695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:35:19.104130 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:35:19.105864 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:35:19.107359 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 12:35:19.104350 => 12:35:19.107138
[0m12:35:19.107719 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:35:19.113084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:35:19.114438 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:35:19.114813 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m12:35:19.115227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:19.381246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:19.388577 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 12:35:19.107913 => 12:35:19.388246
[0m12:35:19.389276 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:35:19.451688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe2c50>]}
[0m12:35:19.453213 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.35s]
[0m12:35:19.454437 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:35:19.455236 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:35:19.456037 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m12:35:19.456899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:35:19.457253 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:35:19.460724 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:35:19.461928 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 12:35:19.457469 => 12:35:19.461625
[0m12:35:19.462391 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:35:19.465802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:35:19.466838 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:35:19.467174 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') a host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
  );
[0m12:35:19.467489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:19.642225 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b75a97-0001-5d05-0000-0001e146e295
[0m12:35:19.642754 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 37 unexpected 'host_name'.
[0m12:35:19.643300 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 12:35:19.462646 => 12:35:19.643087
[0m12:35:19.643736 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:35:19.699844 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 37 unexpected 'host_name'.
  compiled Code at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m12:35:19.700462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128aba50>]}
[0m12:35:19.701114 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model DEV.dim_hosts_cleansed .................... [[31mERROR[0m in 0.24s]
[0m12:35:19.701696 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:35:19.702129 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:35:19.703440 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m12:35:19.704402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:35:19.704831 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:35:19.707880 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:35:19.716704 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 12:35:19.705150 => 12:35:19.716547
[0m12:35:19.716972 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:35:19.719778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:35:19.720616 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:35:19.720845 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
  );
[0m12:35:19.721067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:35:20.036299 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:20.041978 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 12:35:19.717089 => 12:35:20.041695
[0m12:35:20.042780 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:35:20.114871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '677491cc-274d-4e0f-ae20-30fe39402d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129cfd10>]}
[0m12:35:20.116503 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.41s]
[0m12:35:20.117508 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:35:20.119579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:20.120106 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m12:35:20.120631 [info ] [MainThread]: 
[0m12:35:20.121056 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m12:35:20.122088 [debug] [MainThread]: Command end result
[0m12:35:20.134629 [info ] [MainThread]: 
[0m12:35:20.135028 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:35:20.135505 [info ] [MainThread]: 
[0m12:35:20.135876 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 37 unexpected 'host_name'.
  compiled Code at target/run/dbtlearn/models/dim/dim_hosts_cleansed.sql
[0m12:35:20.136142 [info ] [MainThread]: 
[0m12:35:20.136403 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m12:35:20.138766 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3018663, "process_user_time": 1.478717, "process_kernel_time": 0.225394, "process_mem_max_rss": "146849792", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:35:20.139264 [debug] [MainThread]: Command `dbt run` failed at 12:35:20.139173 after 3.30 seconds
[0m12:35:20.139682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b8ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032f9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10322bf50>]}
[0m12:35:20.139975 [debug] [MainThread]: Flushing usage events
[0m12:36:52.587497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11191d3d0>]}


============================== 12:36:52.590350 | a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7 ==============================
[0m12:36:52.590350 [info ] [MainThread]: Running with dbt=1.7.1
[0m12:36:52.590679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:36:52.748136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e5410>]}
[0m12:36:52.779845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112321890>]}
[0m12:36:52.780365 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:36:52.788728 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m12:36:52.804151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:52.804399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:36:52.807415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123e35d0>]}
[0m12:36:52.812845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124d9bd0>]}
[0m12:36:52.813074 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m12:36:52.813255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112567d90>]}
[0m12:36:52.814162 [info ] [MainThread]: 
[0m12:36:52.814549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:52.815135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:36:52.821350 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:36:52.821524 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:36:52.821675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:53.352046 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:36:53.355119 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:36:53.404240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m12:36:53.413521 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:36:53.413903 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m12:36:53.414184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:53.595474 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:36:53.601627 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:36:53.648394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11233ed50>]}
[0m12:36:53.649364 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:53.649770 [info ] [MainThread]: 
[0m12:36:53.654198 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m12:36:53.654718 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m12:36:53.655465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m12:36:53.655836 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m12:36:53.662355 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m12:36:53.663639 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 12:36:53.656070 => 12:36:53.663420
[0m12:36:53.663978 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m12:36:53.683670 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m12:36:53.684376 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m12:36:53.684618 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m12:36:53.684833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:53.959619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:53.983784 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 12:36:53.664168 => 12:36:53.983586
[0m12:36:53.984210 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m12:36:54.029508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bd590>]}
[0m12:36:54.030146 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.37s]
[0m12:36:54.030713 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m12:36:54.031139 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m12:36:54.031729 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m12:36:54.032509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m12:36:54.032875 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m12:36:54.034511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m12:36:54.035320 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 12:36:54.033073 => 12:36:54.035150
[0m12:36:54.035615 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m12:36:54.038658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m12:36:54.039588 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m12:36:54.039873 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m12:36:54.040146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:54.326265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:54.331707 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 12:36:54.035792 => 12:36:54.331399
[0m12:36:54.332359 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m12:36:54.384721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124da510>]}
[0m12:36:54.386200 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.35s]
[0m12:36:54.387048 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m12:36:54.387609 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m12:36:54.388430 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m12:36:54.389369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m12:36:54.389838 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m12:36:54.391752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m12:36:54.393068 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 12:36:54.390123 => 12:36:54.392872
[0m12:36:54.393413 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m12:36:54.398545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m12:36:54.399411 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m12:36:54.399728 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m12:36:54.400023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:54.687409 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:54.693637 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 12:36:54.393620 => 12:36:54.693338
[0m12:36:54.694641 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m12:36:54.741947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112384210>]}
[0m12:36:54.743371 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.35s]
[0m12:36:54.744189 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m12:36:54.744747 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m12:36:54.745416 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m12:36:54.746412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m12:36:54.746873 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m12:36:54.750433 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:36:54.751417 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 12:36:54.747103 => 12:36:54.751206
[0m12:36:54.751777 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m12:36:54.755615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m12:36:54.756658 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m12:36:54.756988 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
  );
[0m12:36:54.757588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:55.216689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:55.221786 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 12:36:54.751993 => 12:36:55.221479
[0m12:36:55.222510 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m12:36:55.276128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125a4ed0>]}
[0m12:36:55.277746 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.53s]
[0m12:36:55.278769 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m12:36:55.279414 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m12:36:55.280290 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m12:36:55.281491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m12:36:55.281958 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m12:36:55.285060 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m12:36:55.286391 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 12:36:55.282229 => 12:36:55.286092
[0m12:36:55.286824 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m12:36:55.290468 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m12:36:55.291491 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m12:36:55.291838 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
  );
[0m12:36:55.292160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:36:55.792207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:36:55.797329 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 12:36:55.287053 => 12:36:55.797060
[0m12:36:55.797818 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m12:36:55.846276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a891d0db-4fa6-4efa-b814-dcfa7d3fe0a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112851cd0>]}
[0m12:36:55.847337 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.57s]
[0m12:36:55.848067 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m12:36:55.850391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:55.850815 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m12:36:55.851199 [info ] [MainThread]: 
[0m12:36:55.851555 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m12:36:55.852621 [debug] [MainThread]: Command end result
[0m12:36:55.862447 [info ] [MainThread]: 
[0m12:36:55.862801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:55.863076 [info ] [MainThread]: 
[0m12:36:55.863359 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:36:55.865791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.3044543, "process_user_time": 1.408657, "process_kernel_time": 0.194894, "process_mem_max_rss": "144539648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:36:55.866394 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:55.866282 after 3.31 seconds
[0m12:36:55.866760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11117c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104645f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cdfd0>]}
[0m12:36:55.867107 [debug] [MainThread]: Flushing usage events
[0m13:23:47.883301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10495b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cd8d0>]}


============================== 13:23:47.886222 | 0b1781c7-58ef-4e50-9d37-d435f5fe8959 ==============================
[0m13:23:47.886222 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:23:47.886547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:48.067624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbb710>]}
[0m13:23:48.099884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ad6d0>]}
[0m13:23:48.100304 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:23:48.108800 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:23:48.124547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:48.124770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:48.127777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6c590>]}
[0m13:23:48.134451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc1d10>]}
[0m13:23:48.134688 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m13:23:48.134889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfe250>]}
[0m13:23:48.135780 [info ] [MainThread]: 
[0m13:23:48.136170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:48.136746 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:23:48.142684 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:23:48.142857 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:23:48.142998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:48.631063 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:23:48.633471 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:23:48.692510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:23:48.702605 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:23:48.703074 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:23:48.703361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:49.076025 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:23:49.079277 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:23:49.131387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c45f10>]}
[0m13:23:49.132863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:23:49.133459 [info ] [MainThread]: 
[0m13:23:49.136517 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m13:23:49.137065 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m13:23:49.137830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m13:23:49.138186 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m13:23:49.145102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:23:49.146232 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 13:23:49.138411 => 13:23:49.146030
[0m13:23:49.146569 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m13:23:49.168143 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m13:23:49.168881 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:23:49.169119 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m13:23:49.169349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:49.613597 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:23:49.638423 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 13:23:49.146757 => 13:23:49.638214
[0m13:23:49.638958 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m13:23:49.679629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0e150>]}
[0m13:23:49.680345 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.54s]
[0m13:23:49.680878 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m13:23:49.681432 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m13:23:49.682229 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m13:23:49.683640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m13:23:49.684041 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m13:23:49.685591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:23:49.686760 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 13:23:49.684266 => 13:23:49.686570
[0m13:23:49.687043 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m13:23:49.692221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m13:23:49.693958 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:23:49.694331 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m13:23:49.694590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:49.991741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:23:49.995982 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 13:23:49.687203 => 13:23:49.995737
[0m13:23:49.996535 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m13:23:50.048135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a7110>]}
[0m13:23:50.050281 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.36s]
[0m13:23:50.051331 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m13:23:50.051996 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m13:23:50.052981 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:23:50.054253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m13:23:50.054873 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m13:23:50.056971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:23:50.058263 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 13:23:50.055177 => 13:23:50.057977
[0m13:23:50.058933 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m13:23:50.065361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m13:23:50.066421 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:23:50.066767 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m13:23:50.067073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:50.313458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:23:50.317995 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 13:23:50.059226 => 13:23:50.317645
[0m13:23:50.318694 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m13:23:50.362759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11096e350>]}
[0m13:23:50.363874 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.31s]
[0m13:23:50.364594 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m13:23:50.365147 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:23:50.365798 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m13:23:50.366889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m13:23:50.367634 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:23:50.371863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:23:50.373466 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 13:23:50.367958 => 13:23:50.373136
[0m13:23:50.373924 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:23:50.383260 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m13:23:50.389863 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m13:23:50.395456 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:23:50.395777 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m13:23:50.396050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:50.558656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:23:50.571357 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:23:50.572567 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:23:50.572913 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m13:23:51.524126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:51.529710 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 13:23:50.374167 => 13:23:51.529411
[0m13:23:51.530302 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:23:51.576114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccb510>]}
[0m13:23:51.577389 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.21s]
[0m13:23:51.578184 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:23:51.578999 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:23:51.579774 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m13:23:51.580797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m13:23:51.581281 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:23:51.585069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:23:51.586599 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 13:23:51.581561 => 13:23:51.586376
[0m13:23:51.586966 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:23:51.589553 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type view
[0m13:23:51.591933 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m13:23:51.592849 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:23:51.593156 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m13:23:51.593445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:51.971205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:23:51.974279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m13:23:51.976413 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:23:51.977156 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m13:23:52.918169 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:52.922236 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 13:23:51.587185 => 13:23:52.921967
[0m13:23:52.922868 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:23:52.972269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1781c7-58ef-4e50-9d37-d435f5fe8959', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c6ca10>]}
[0m13:23:52.973029 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.39s]
[0m13:23:52.973576 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:23:52.975460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:52.975823 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was properly closed.
[0m13:23:52.976096 [info ] [MainThread]: 
[0m13:23:52.976355 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m13:23:52.977075 [debug] [MainThread]: Command end result
[0m13:23:52.984329 [info ] [MainThread]: 
[0m13:23:52.984679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:52.984896 [info ] [MainThread]: 
[0m13:23:52.985110 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:23:52.986984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1324205, "process_user_time": 1.445805, "process_kernel_time": 0.211999, "process_mem_max_rss": "139575296", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:23:52.987441 [debug] [MainThread]: Command `dbt run` succeeded at 13:23:52.987358 after 5.13 seconds
[0m13:23:52.987726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10047f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbb610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cd2d0>]}
[0m13:23:52.987987 [debug] [MainThread]: Flushing usage events
[0m13:32:01.313801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b50a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc90d0>]}


============================== 13:32:01.316683 | a0cea16c-d96d-4cb7-849d-d799aee9dbcd ==============================
[0m13:32:01.316683 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:32:01.316996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:01.473092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0cea16c-d96d-4cb7-849d-d799aee9dbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105408190>]}
[0m13:32:01.505566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0cea16c-d96d-4cb7-849d-d799aee9dbcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba3850>]}
[0m13:32:01.506062 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:32:01.517935 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:32:01.545852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:01.546177 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/fct/fct_reviews.sql
[0m13:32:01.616611 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  expected token ',', got ':'
    line 3
      materialized: 'incremental',
[0m13:32:01.618187 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3303108, "process_user_time": 0.976677, "process_kernel_time": 0.139268, "process_mem_max_rss": "126959616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:01.618499 [debug] [MainThread]: Command `dbt run` failed at 13:32:01.618435 after 0.33 seconds
[0m13:32:01.618799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057acd10>]}
[0m13:32:01.619002 [debug] [MainThread]: Flushing usage events
[0m13:32:43.401095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e451d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e933d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e939d0>]}


============================== 13:32:43.403525 | 37718043-c58a-4c8c-b270-0de6ac7a9234 ==============================
[0m13:32:43.403525 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:32:43.403825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:43.539730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d9cd0>]}
[0m13:32:43.571762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108123d10>]}
[0m13:32:43.572428 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:32:43.580398 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:32:43.600862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:43.601068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:43.604087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10982ff90>]}
[0m13:32:43.610294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109891e50>]}
[0m13:32:43.610513 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m13:32:43.610688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a1d10>]}
[0m13:32:43.611673 [info ] [MainThread]: 
[0m13:32:43.612087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:32:43.612758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:32:43.618754 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:32:43.618933 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:32:43.619080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:44.064668 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:32:44.067926 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:32:44.127235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:32:44.136381 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:32:44.136773 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:32:44.137059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:44.501386 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:32:44.505635 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:32:44.561274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108123a50>]}
[0m13:32:44.562332 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:44.562751 [info ] [MainThread]: 
[0m13:32:44.565435 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m13:32:44.565794 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m13:32:44.566217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m13:32:44.566409 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m13:32:44.569713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:32:44.570808 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 13:32:44.566535 => 13:32:44.570634
[0m13:32:44.571066 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m13:32:44.585015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m13:32:44.585925 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:32:44.586176 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m13:32:44.586375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:44.863423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:44.887865 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 13:32:44.571183 => 13:32:44.887693
[0m13:32:44.888270 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m13:32:44.939422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109863850>]}
[0m13:32:44.940174 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.37s]
[0m13:32:44.940794 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m13:32:44.941236 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m13:32:44.941858 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m13:32:44.942706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m13:32:44.943104 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m13:32:44.944805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:32:44.946604 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 13:32:44.943317 => 13:32:44.946424
[0m13:32:44.946913 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m13:32:44.950264 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m13:32:44.951248 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:32:44.951552 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m13:32:44.951835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:45.237777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:45.243519 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 13:32:44.947096 => 13:32:45.243235
[0m13:32:45.244110 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m13:32:45.286254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702ed0>]}
[0m13:32:45.287351 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.34s]
[0m13:32:45.288195 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m13:32:45.288778 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m13:32:45.289611 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:32:45.290587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m13:32:45.291054 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m13:32:45.293187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:32:45.295861 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 13:32:45.291330 => 13:32:45.295654
[0m13:32:45.296212 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m13:32:45.301318 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m13:32:45.302273 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:32:45.302604 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m13:32:45.302918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:45.754869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:45.761271 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 13:32:45.296422 => 13:32:45.761008
[0m13:32:45.761803 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m13:32:45.811898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109720650>]}
[0m13:32:45.812825 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.52s]
[0m13:32:45.813572 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m13:32:45.814106 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:32:45.814848 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m13:32:45.815741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m13:32:45.816106 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:32:45.819513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:32:45.821267 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 13:32:45.816330 => 13:32:45.821054
[0m13:32:45.821634 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:32:45.839763 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:32:45.840846 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:32:45.841128 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m13:32:45.841396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:46.700347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:46.704792 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 13:32:45.821851 => 13:32:46.704497
[0m13:32:46.705493 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:32:46.758075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b1ed90>]}
[0m13:32:46.759616 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m13:32:46.760407 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:32:46.760958 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:32:46.761656 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m13:32:46.762650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m13:32:46.763084 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:32:46.766713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:32:46.768082 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 13:32:46.763320 => 13:32:46.767866
[0m13:32:46.768452 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:32:46.771531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m13:32:46.773471 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:32:46.773831 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m13:32:46.774151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:47.633568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:47.639380 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 13:32:46.768671 => 13:32:47.639079
[0m13:32:47.640052 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:32:47.695850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b14f90>]}
[0m13:32:47.696956 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.93s]
[0m13:32:47.697767 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:32:47.698326 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m13:32:47.698982 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m13:32:47.700087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m13:32:47.700803 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m13:32:47.708734 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m13:32:47.709817 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 13:32:47.701131 => 13:32:47.709632
[0m13:32:47.710136 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m13:32:47.736368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m13:32:47.737148 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:32:47.737383 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

        );
[0m13:32:47.737601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:50.262222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:32:50.272816 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:32:50.280369 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:32:50.280859 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m13:32:50.316190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:32:50.320548 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 13:32:47.710316 => 13:32:50.320238
[0m13:32:50.321157 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m13:32:50.369862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37718043-c58a-4c8c-b270-0de6ac7a9234', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a061e10>]}
[0m13:32:50.371270 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 2.67s]
[0m13:32:50.372508 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m13:32:50.375580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:50.376141 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m13:32:50.376687 [info ] [MainThread]: 
[0m13:32:50.377229 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 6.76 seconds (6.76s).
[0m13:32:50.379166 [debug] [MainThread]: Command end result
[0m13:32:50.390272 [info ] [MainThread]: 
[0m13:32:50.390603 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:50.390818 [info ] [MainThread]: 
[0m13:32:50.391025 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:32:50.392919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.016728, "process_user_time": 1.502908, "process_kernel_time": 0.19592, "process_mem_max_rss": "140853248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:50.393454 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:50.393360 after 7.02 seconds
[0m13:32:50.393817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104967550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087e5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494df50>]}
[0m13:32:50.394213 [debug] [MainThread]: Flushing usage events
[0m13:36:59.144078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f7a50>]}


============================== 13:36:59.146820 | d5c3f934-1c32-40de-a7aa-3994e41cc485 ==============================
[0m13:36:59.146820 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:36:59.147146 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:36:59.300442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10695bb90>]}
[0m13:36:59.332330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562bbd0>]}
[0m13:36:59.332710 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:36:59.341651 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:36:59.372317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:59.372561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:59.375491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e7350>]}
[0m13:36:59.381453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ada090>]}
[0m13:36:59.381669 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m13:36:59.381840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657ed0>]}
[0m13:36:59.382792 [info ] [MainThread]: 
[0m13:36:59.383160 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:36:59.383874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:36:59.390042 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:36:59.390230 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:36:59.390370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:59.850742 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:36:59.854431 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:36:59.954956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:36:59.965062 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:36:59.965448 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:36:59.965690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:00.199900 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m13:37:00.205096 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:37:00.264987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b48990>]}
[0m13:37:00.266354 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:37:00.267421 [info ] [MainThread]: 
[0m13:37:00.271291 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m13:37:00.271888 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m13:37:00.272575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m13:37:00.272800 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m13:37:00.277118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:37:00.277939 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 13:37:00.272943 => 13:37:00.277804
[0m13:37:00.278171 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m13:37:00.300423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m13:37:00.301304 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m13:37:00.301569 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m13:37:00.301799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:00.748496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:37:00.768302 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 13:37:00.278336 => 13:37:00.768047
[0m13:37:00.768735 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m13:37:00.816750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b2ecd0>]}
[0m13:37:00.817575 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.54s]
[0m13:37:00.818179 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m13:37:00.818624 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m13:37:00.819303 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m13:37:00.820192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m13:37:00.820613 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m13:37:00.822494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:37:00.823311 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 13:37:00.820849 => 13:37:00.823111
[0m13:37:00.823668 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m13:37:00.827066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m13:37:00.828403 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m13:37:00.828735 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m13:37:00.829047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:01.118489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:37:01.123080 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 13:37:00.823879 => 13:37:01.122616
[0m13:37:01.123771 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m13:37:01.172435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ada750>]}
[0m13:37:01.173950 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.35s]
[0m13:37:01.174959 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m13:37:01.175523 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m13:37:01.176297 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:37:01.177288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m13:37:01.177791 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m13:37:01.179744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:37:01.182187 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 13:37:01.178048 => 13:37:01.181981
[0m13:37:01.182541 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m13:37:01.188006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m13:37:01.189718 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m13:37:01.190068 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m13:37:01.190373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:01.602536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:37:01.607149 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 13:37:01.182751 => 13:37:01.606831
[0m13:37:01.607983 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m13:37:01.668263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eef950>]}
[0m13:37:01.670016 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.49s]
[0m13:37:01.671287 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m13:37:01.672116 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:37:01.672958 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m13:37:01.674260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m13:37:01.674799 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:37:01.678144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:37:01.679606 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 13:37:01.675035 => 13:37:01.679303
[0m13:37:01.680071 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:37:01.698024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:37:01.699118 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:37:01.699415 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m13:37:01.699667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:02.497461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:37:02.502878 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 13:37:01.680315 => 13:37:02.502583
[0m13:37:02.503798 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m13:37:02.567281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eefa10>]}
[0m13:37:02.568474 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.89s]
[0m13:37:02.569207 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:37:02.569725 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:37:02.570393 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m13:37:02.571583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m13:37:02.572044 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:37:02.575538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:37:02.576711 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 13:37:02.572282 => 13:37:02.576466
[0m13:37:02.577096 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:37:02.580085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m13:37:02.581290 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:37:02.581642 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m13:37:02.581967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:03.246675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:37:03.251515 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 13:37:02.577298 => 13:37:03.251222
[0m13:37:03.252088 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m13:37:03.305489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0b8d0>]}
[0m13:37:03.306374 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.73s]
[0m13:37:03.307023 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:37:03.307492 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m13:37:03.308111 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m13:37:03.308848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m13:37:03.309163 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m13:37:03.315408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m13:37:03.316752 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 13:37:03.309325 => 13:37:03.316564
[0m13:37:03.317031 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m13:37:03.342823 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:03.343290 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m13:37:03.343568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:03.655851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:37:03.667088 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:03.667662 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:37:03.718038 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:37:03.725168 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:03.725919 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m13:37:03.772798 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:37:03.790911 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:03.791482 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:37:03.849121 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:37:03.854153 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:03.854594 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:37:03.894845 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:37:03.906374 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:37:03.920260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m13:37:03.921208 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:03.921558 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:37:03.986266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:37:03.986767 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:03.987197 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m13:37:04.489203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:37:04.490076 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:04.490500 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m13:37:04.674850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:37:04.687170 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:37:04.694036 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:37:04.694407 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m13:37:04.762885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:37:04.766853 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 13:37:03.317188 => 13:37:04.766580
[0m13:37:04.767420 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m13:37:04.816426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5c3f934-1c32-40de-a7aa-3994e41cc485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbda90>]}
[0m13:37:04.817476 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 1.51s]
[0m13:37:04.818223 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m13:37:04.820258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:04.820668 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was properly closed.
[0m13:37:04.821031 [info ] [MainThread]: 
[0m13:37:04.821339 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m13:37:04.822431 [debug] [MainThread]: Command end result
[0m13:37:04.831629 [info ] [MainThread]: 
[0m13:37:04.832090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:04.832543 [info ] [MainThread]: 
[0m13:37:04.832845 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:37:04.835028 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.7184744, "process_user_time": 1.626328, "process_kernel_time": 0.218927, "process_mem_max_rss": "140967936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:37:04.835592 [debug] [MainThread]: Command `dbt run` succeeded at 13:37:04.835477 after 5.72 seconds
[0m13:37:04.835927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007db550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1007c1f50>]}
[0m13:37:04.836220 [debug] [MainThread]: Flushing usage events
[0m14:15:20.525992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055185d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047fba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558d3d0>]}


============================== 14:15:20.528846 | 80976252-e8cf-4054-91cd-f688c2db86dc ==============================
[0m14:15:20.528846 [info ] [MainThread]: Running with dbt=1.7.1
[0m14:15:20.529170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:15:20.681795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddadd0>]}
[0m14:15:20.713741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebe8d0>]}
[0m14:15:20.714121 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:15:20.722211 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m14:15:20.743390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:20.743604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:20.746517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2b390>]}
[0m14:15:20.753279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6b190>]}
[0m14:15:20.753501 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m14:15:20.753679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102879d10>]}
[0m14:15:20.754662 [info ] [MainThread]: 
[0m14:15:20.755036 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:20.755680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:15:20.761776 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:15:20.761969 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:15:20.762122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:21.220947 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:15:21.223840 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:15:21.277722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m14:15:21.289140 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:15:21.289737 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:15:21.290033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:21.642914 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:15:21.645788 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:15:21.701134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c76110>]}
[0m14:15:21.703488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:15:21.704222 [info ] [MainThread]: 
[0m14:15:21.708045 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m14:15:21.708570 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_hosts ...................................... [RUN]
[0m14:15:21.709359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m14:15:21.709789 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m14:15:21.716990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m14:15:21.719145 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 14:15:21.710031 => 14:15:21.719003
[0m14:15:21.719366 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m14:15:21.737537 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m14:15:21.738552 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m14:15:21.738861 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m14:15:21.739105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:22.238850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:22.264562 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 14:15:21.719469 => 14:15:22.264366
[0m14:15:22.264997 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m14:15:22.308705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dce150>]}
[0m14:15:22.309461 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.60s]
[0m14:15:22.310099 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m14:15:22.310555 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m14:15:22.311159 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_listings ................................... [RUN]
[0m14:15:22.311836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m14:15:22.312158 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m14:15:22.313766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m14:15:22.314917 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 14:15:22.312344 => 14:15:22.314739
[0m14:15:22.315220 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m14:15:22.318207 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m14:15:22.319345 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m14:15:22.319632 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m14:15:22.319902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:22.804272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:22.811525 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 14:15:22.315405 => 14:15:22.810713
[0m14:15:22.812242 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m14:15:22.861760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6a1d0>]}
[0m14:15:22.863023 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.55s]
[0m14:15:22.863917 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m14:15:22.864463 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m14:15:22.865222 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_reviews .................................... [RUN]
[0m14:15:22.866181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m14:15:22.866633 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m14:15:22.868834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m14:15:22.871515 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 14:15:22.866908 => 14:15:22.871304
[0m14:15:22.871928 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m14:15:22.877622 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m14:15:22.879334 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m14:15:22.879859 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m14:15:22.880282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:23.154896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:23.158815 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 14:15:22.872149 => 14:15:23.158561
[0m14:15:23.159356 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m14:15:23.204511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10628cd10>]}
[0m14:15:23.205415 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.34s]
[0m14:15:23.206204 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m14:15:23.206779 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m14:15:23.207493 [info ] [Thread-1 (]: 4 of 7 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m14:15:23.208422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m14:15:23.208908 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m14:15:23.213291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m14:15:23.215658 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 14:15:23.209162 => 14:15:23.215204
[0m14:15:23.216220 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m14:15:23.234793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m14:15:23.235893 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m14:15:23.236250 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m14:15:23.236565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:24.398865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:15:24.403980 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 14:15:23.216482 => 14:15:24.403683
[0m14:15:24.404529 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m14:15:24.457566 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef9d50>]}
[0m14:15:24.458998 [info ] [Thread-1 (]: 4 of 7 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.25s]
[0m14:15:24.460079 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m14:15:24.460801 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m14:15:24.461515 [info ] [Thread-1 (]: 5 of 7 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m14:15:24.462753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m14:15:24.463445 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m14:15:24.467191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m14:15:24.468565 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 14:15:24.463761 => 14:15:24.468246
[0m14:15:24.469022 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m14:15:24.471829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m14:15:24.473264 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m14:15:24.473699 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m14:15:24.474046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:25.396241 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:15:25.400685 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 14:15:24.469260 => 14:15:25.400404
[0m14:15:25.401260 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m14:15:25.470876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652b710>]}
[0m14:15:25.472682 [info ] [Thread-1 (]: 5 of 7 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.01s]
[0m14:15:25.473966 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m14:15:25.474741 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m14:15:25.476172 [info ] [Thread-1 (]: 6 of 7 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m14:15:25.477365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m14:15:25.477858 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m14:15:25.487935 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m14:15:25.489811 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 14:15:25.478137 => 14:15:25.489585
[0m14:15:25.490193 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m14:15:25.515383 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:25.515794 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m14:15:25.516053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:25.798251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:25.811888 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:25.812401 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m14:15:25.859900 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:15:25.862975 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:25.863220 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m14:15:25.901905 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:15:25.909233 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:25.909646 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m14:15:26.055949 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:15:26.059331 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:26.059792 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m14:15:26.114054 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:15:26.126794 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:15:26.145379 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m14:15:26.146242 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:26.146461 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m14:15:26.204797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:26.205516 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:26.205994 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m14:15:26.376619 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m14:15:26.377882 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:26.378560 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m14:15:26.450964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:26.468453 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m14:15:26.478946 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m14:15:26.479645 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m14:15:26.547721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:15:26.549348 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 14:15:25.490550 => 14:15:26.549126
[0m14:15:26.549635 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m14:15:26.592697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6abd0>]}
[0m14:15:26.593704 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.12s]
[0m14:15:26.594578 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m14:15:26.595151 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m14:15:26.595765 [info ] [Thread-1 (]: 7 of 7 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m14:15:26.596703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m14:15:26.597146 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m14:15:26.602606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m14:15:26.603865 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 14:15:26.597582 => 14:15:26.603570
[0m14:15:26.604471 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m14:15:26.609607 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m14:15:26.613457 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m14:15:26.614290 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (with
l as (
    select * from AIRBNB.DEV.dim_listings_cleansed
),
h as (
    select * from AIRBNB.DEV.dim_hosts_cleansed
)

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at,
from l
left join h 
    on h.host_id = l.host_id
        );
[0m14:15:26.614905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:27.008719 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b75afb-0001-5d05-0000-0001e146e415
[0m14:15:27.009400 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'HOST_ID'
[0m14:15:27.010050 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 14:15:26.604857 => 14:15:27.009798
[0m14:15:27.010549 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m14:15:27.055462 [debug] [Thread-1 (]: Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'HOST_ID'
  compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m14:15:27.056554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80976252-e8cf-4054-91cd-f688c2db86dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656a710>]}
[0m14:15:27.057546 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model DEV.dim_listings_w_hosts ................. [[31mERROR[0m in 0.46s]
[0m14:15:27.058402 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m14:15:27.061612 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:27.062130 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m14:15:27.062616 [info ] [MainThread]: 
[0m14:15:27.063438 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m14:15:27.065875 [debug] [MainThread]: Command end result
[0m14:15:27.079483 [info ] [MainThread]: 
[0m14:15:27.079936 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:15:27.080215 [info ] [MainThread]: 
[0m14:15:27.080475 [error] [MainThread]:   Database Error in model dim_listings_w_hosts (models/dim/dim_listings_w_hosts.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'HOST_ID'
  compiled Code at target/run/dbtlearn/models/dim/dim_listings_w_hosts.sql
[0m14:15:27.080755 [info ] [MainThread]: 
[0m14:15:27.081018 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:15:27.083153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5846624, "process_user_time": 1.679118, "process_kernel_time": 0.22588, "process_mem_max_rss": "140656640", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:15:27.084031 [debug] [MainThread]: Command `dbt run` failed at 14:15:27.083801 after 6.59 seconds
[0m14:15:27.084589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10103f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1010e8d90>]}
[0m14:15:27.085044 [debug] [MainThread]: Flushing usage events
[0m15:07:16.780200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098af090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991cf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991da90>]}


============================== 15:07:16.783655 | 5c4d6b3e-196e-49c3-9747-8968c94acac1 ==============================
[0m15:07:16.783655 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:07:16.783958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:07:16.946897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f7590>]}
[0m15:07:16.984958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109931ed0>]}
[0m15:07:16.985706 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:07:17.000149 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:07:17.024084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:17.024339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:17.028141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878a710>]}
[0m15:07:17.035252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44f010>]}
[0m15:07:17.035541 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m15:07:17.035723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de1cd0>]}
[0m15:07:17.036870 [info ] [MainThread]: 
[0m15:07:17.037310 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:07:17.038110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:07:17.044826 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:07:17.045040 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:07:17.045185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:17.516006 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:07:17.518848 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:07:17.590270 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m15:07:17.599167 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:07:17.600546 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m15:07:17.600964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:17.836422 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m15:07:17.838914 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:07:17.899300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4bd690>]}
[0m15:07:17.900827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:07:17.901539 [info ] [MainThread]: 
[0m15:07:17.906212 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m15:07:17.907034 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_hosts ...................................... [RUN]
[0m15:07:17.908074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m15:07:17.908849 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m15:07:17.919785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m15:07:17.921709 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 15:07:17.909249 => 15:07:17.921300
[0m15:07:17.922167 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m15:07:17.945030 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m15:07:17.946555 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m15:07:17.947016 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m15:07:17.947332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:18.440766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:18.483716 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 15:07:17.922375 => 15:07:18.483564
[0m15:07:18.484141 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m15:07:18.533588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a942dd0>]}
[0m15:07:18.534922 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.63s]
[0m15:07:18.535704 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m15:07:18.536249 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m15:07:18.537113 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_listings ................................... [RUN]
[0m15:07:18.538090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m15:07:18.538600 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m15:07:18.541553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m15:07:18.542916 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 15:07:18.538866 => 15:07:18.542628
[0m15:07:18.543602 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m15:07:18.548111 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m15:07:18.549160 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m15:07:18.549555 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m15:07:18.549818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:19.095273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:19.104667 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 15:07:18.543924 => 15:07:19.103394
[0m15:07:19.105550 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m15:07:19.163051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44ddd0>]}
[0m15:07:19.164441 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.63s]
[0m15:07:19.165272 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m15:07:19.165795 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m15:07:19.166552 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_reviews .................................... [RUN]
[0m15:07:19.167507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m15:07:19.168014 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m15:07:19.170473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m15:07:19.172076 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 15:07:19.168323 => 15:07:19.171782
[0m15:07:19.172561 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m15:07:19.180689 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m15:07:19.184243 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m15:07:19.184844 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m15:07:19.185286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:19.465135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:19.469101 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 15:07:19.172809 => 15:07:19.468855
[0m15:07:19.469595 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m15:07:19.518900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72da90>]}
[0m15:07:19.520126 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.35s]
[0m15:07:19.521420 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m15:07:19.522146 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m15:07:19.523205 [info ] [Thread-1 (]: 4 of 7 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m15:07:19.524287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m15:07:19.524922 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m15:07:19.531251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:07:19.533280 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 15:07:19.526365 => 15:07:19.532848
[0m15:07:19.535104 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m15:07:19.561939 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:07:19.563846 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m15:07:19.564382 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m15:07:19.564712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:21.195020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:07:21.199035 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 15:07:19.535714 => 15:07:21.198742
[0m15:07:21.199552 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m15:07:21.245968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3cda10>]}
[0m15:07:21.249840 [info ] [Thread-1 (]: 4 of 7 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.72s]
[0m15:07:21.251132 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m15:07:21.251927 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m15:07:21.252667 [info ] [Thread-1 (]: 5 of 7 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m15:07:21.253862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m15:07:21.254551 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m15:07:21.260591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m15:07:21.262390 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 15:07:21.254980 => 15:07:21.262046
[0m15:07:21.262897 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m15:07:21.267484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m15:07:21.268359 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m15:07:21.268584 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m15:07:21.268801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:22.129314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:22.134661 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 15:07:21.263223 => 15:07:22.134395
[0m15:07:22.135404 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m15:07:22.195796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72c090>]}
[0m15:07:22.197108 [info ] [Thread-1 (]: 5 of 7 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.94s]
[0m15:07:22.197940 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m15:07:22.198486 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m15:07:22.199279 [info ] [Thread-1 (]: 6 of 7 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m15:07:22.200632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m15:07:22.202071 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m15:07:22.219193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m15:07:22.221351 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 15:07:22.202415 => 15:07:22.220963
[0m15:07:22.222095 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m15:07:22.255232 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:22.255705 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m15:07:22.256013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:22.565590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:22.584357 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:22.585185 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:07:22.635136 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:07:22.642240 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:22.642881 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m15:07:22.681372 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:07:22.700927 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:22.701589 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:07:22.754851 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:07:22.762093 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:22.762885 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m15:07:22.800173 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:07:22.815405 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:07:22.835573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m15:07:22.837666 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:22.838159 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m15:07:22.892599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:22.893513 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:22.894036 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m15:07:23.310961 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:07:23.311988 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:23.316347 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m15:07:23.380728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:23.393460 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:07:23.402591 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:07:23.403308 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m15:07:23.471334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:07:23.475269 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 15:07:22.222724 => 15:07:23.475004
[0m15:07:23.475847 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m15:07:23.522152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a535710>]}
[0m15:07:23.523228 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.32s]
[0m15:07:23.524144 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m15:07:23.525005 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m15:07:23.525646 [info ] [Thread-1 (]: 7 of 7 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m15:07:23.526584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m15:07:23.527608 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m15:07:23.534792 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:07:23.536599 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 15:07:23.528033 => 15:07:23.536205
[0m15:07:23.537122 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m15:07:23.542235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:07:23.544480 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m15:07:23.545060 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (with
l as (
    select * from AIRBNB.DEV.dim_listings_cleansed
),
h as (
    select * from AIRBNB.DEV.dim_hosts_cleansed
)

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at,
from l
left join h 
    on h.host_id = l.host_id
        );
[0m15:07:23.545503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:24.350978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:07:24.356752 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 15:07:23.537422 => 15:07:24.356491
[0m15:07:24.357299 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m15:07:24.411147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c4d6b3e-196e-49c3-9747-8968c94acac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b72c690>]}
[0m15:07:24.412194 [info ] [Thread-1 (]: 7 of 7 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m15:07:24.413189 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m15:07:24.415641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:24.416173 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m15:07:24.416666 [info ] [MainThread]: 
[0m15:07:24.417060 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m15:07:24.418618 [debug] [MainThread]: Command end result
[0m15:07:24.435750 [info ] [MainThread]: 
[0m15:07:24.436537 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:24.437611 [info ] [MainThread]: 
[0m15:07:24.438110 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:07:24.441018 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.690255, "process_user_time": 1.805704, "process_kernel_time": 0.24039, "process_mem_max_rss": "140853248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:24.441823 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:24.441671 after 7.69 seconds
[0m15:07:24.442294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458df50>]}
[0m15:07:24.442737 [debug] [MainThread]: Flushing usage events
[0m15:12:27.862566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072850d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728d650>]}


============================== 15:12:27.865350 | 99232b3a-7bfd-4009-a234-a445c7e6c1c2 ==============================
[0m15:12:27.865350 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:12:27.865666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:12:28.084368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728f6d0>]}
[0m15:12:28.117098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0a0d0>]}
[0m15:12:28.117611 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:12:28.126763 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:12:28.153269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:12:28.153476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:12:28.156414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb1b50>]}
[0m15:12:28.163626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc2bd0>]}
[0m15:12:28.163850 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m15:12:28.164026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfcb50>]}
[0m15:12:28.164957 [info ] [MainThread]: 
[0m15:12:28.165329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:12:28.166013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:12:28.172166 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:12:28.172347 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:12:28.172484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:28.719946 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:12:28.722957 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:12:28.786406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m15:12:28.795945 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:12:28.796344 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m15:12:28.796624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:29.021908 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:12:29.024817 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:12:29.089926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658e110>]}
[0m15:12:29.091250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:12:29.091699 [info ] [MainThread]: 
[0m15:12:29.094685 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m15:12:29.095191 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_hosts ...................................... [RUN]
[0m15:12:29.095879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m15:12:29.096241 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m15:12:29.102770 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m15:12:29.104290 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 15:12:29.096465 => 15:12:29.104101
[0m15:12:29.104617 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m15:12:29.126662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m15:12:29.127518 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m15:12:29.127771 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
  );
[0m15:12:29.128008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:29.517236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:12:29.539154 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (execute): 15:12:29.104815 => 15:12:29.538957
[0m15:12:29.539616 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: Close
[0m15:12:29.582023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2c490>]}
[0m15:12:29.582678 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.49s]
[0m15:12:29.583267 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m15:12:29.583698 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m15:12:29.584390 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_listings ................................... [RUN]
[0m15:12:29.585110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m15:12:29.585437 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m15:12:29.587369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m15:12:29.588132 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 15:12:29.585638 => 15:12:29.587962
[0m15:12:29.588433 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m15:12:29.591224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m15:12:29.592123 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m15:12:29.592454 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
  );
[0m15:12:29.592727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:29.985261 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:12:29.990469 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (execute): 15:12:29.588616 => 15:12:29.990173
[0m15:12:29.991103 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: Close
[0m15:12:30.042883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d34890>]}
[0m15:12:30.044227 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.46s]
[0m15:12:30.045078 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m15:12:30.045969 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m15:12:30.046826 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_reviews .................................... [RUN]
[0m15:12:30.047809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m15:12:30.048265 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m15:12:30.050222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m15:12:30.052280 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 15:12:30.048532 => 15:12:30.052077
[0m15:12:30.052625 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m15:12:30.058138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m15:12:30.059389 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m15:12:30.059750 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
  );
[0m15:12:30.060091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:30.408189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:12:30.411965 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (execute): 15:12:30.052833 => 15:12:30.411697
[0m15:12:30.412574 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: Close
[0m15:12:30.458255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108854350>]}
[0m15:12:30.459699 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.41s]
[0m15:12:30.460623 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m15:12:30.461374 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m15:12:30.462495 [info ] [Thread-1 (]: 4 of 7 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m15:12:30.463561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m15:12:30.464071 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m15:12:30.467372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:12:30.468828 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 15:12:30.464363 => 15:12:30.468560
[0m15:12:30.469222 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m15:12:30.487058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:12:30.488151 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m15:12:30.488457 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m15:12:30.488724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:31.412135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:12:31.421268 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 15:12:30.469439 => 15:12:31.420983
[0m15:12:31.421894 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m15:12:31.486391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108837290>]}
[0m15:12:31.487711 [info ] [Thread-1 (]: 4 of 7 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.02s]
[0m15:12:31.488520 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m15:12:31.489125 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m15:12:31.490036 [info ] [Thread-1 (]: 5 of 7 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m15:12:31.491100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m15:12:31.491572 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m15:12:31.495267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m15:12:31.496666 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 15:12:31.491844 => 15:12:31.496379
[0m15:12:31.497075 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m15:12:31.500027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m15:12:31.501118 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m15:12:31.501457 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m15:12:31.501775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:32.372598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:12:32.377583 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 15:12:31.497321 => 15:12:32.377240
[0m15:12:32.378310 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m15:12:32.444879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e32d0>]}
[0m15:12:32.446047 [info ] [Thread-1 (]: 5 of 7 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.95s]
[0m15:12:32.447129 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m15:12:32.447881 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m15:12:32.448703 [info ] [Thread-1 (]: 6 of 7 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m15:12:32.449642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m15:12:32.450102 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m15:12:32.459228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m15:12:32.460579 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 15:12:32.450371 => 15:12:32.460401
[0m15:12:32.460888 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m15:12:32.485159 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:32.485493 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m15:12:32.485728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:32.759010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:12:32.773682 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:32.774251 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:12:32.830789 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:12:32.837099 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:32.837613 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m15:12:32.876938 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:12:32.893043 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:32.893458 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:12:32.938050 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:12:32.942198 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:32.942580 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m15:12:32.980002 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:12:32.990865 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:12:33.005133 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m15:12:33.006047 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:33.006344 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m15:12:33.071788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:12:33.072204 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:33.072567 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m15:12:33.185778 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:12:33.187108 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:33.187745 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m15:12:33.270914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:12:33.283668 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:12:33.290471 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:12:33.290844 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m15:12:33.714739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:12:33.720317 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 15:12:32.461070 => 15:12:33.720031
[0m15:12:33.720969 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m15:12:33.783604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddfa10>]}
[0m15:12:33.784771 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.33s]
[0m15:12:33.785619 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m15:12:33.786149 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m15:12:33.787176 [info ] [Thread-1 (]: 7 of 7 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m15:12:33.788222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m15:12:33.788698 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m15:12:33.792252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:12:33.793516 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 15:12:33.788932 => 15:12:33.793267
[0m15:12:33.793936 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m15:12:33.797184 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:12:33.799025 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m15:12:33.799409 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (with
l as (
    select * from AIRBNB.DEV.dim_listings_cleansed
),
h as (
    select * from AIRBNB.DEV.dim_hosts_cleansed
)

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at,
from l
left join h 
    on h.host_id = l.host_id
        );
[0m15:12:33.799742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:34.573371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:12:34.578982 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 15:12:33.794171 => 15:12:34.578679
[0m15:12:34.579544 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m15:12:34.629529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99232b3a-7bfd-4009-a234-a445c7e6c1c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca4b10>]}
[0m15:12:34.630966 [info ] [Thread-1 (]: 7 of 7 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m15:12:34.631784 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m15:12:34.633925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:34.634299 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m15:12:34.634717 [info ] [MainThread]: 
[0m15:12:34.635037 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 6.47 seconds (6.47s).
[0m15:12:34.636256 [debug] [MainThread]: Command end result
[0m15:12:34.648098 [info ] [MainThread]: 
[0m15:12:34.648610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:12:34.648938 [info ] [MainThread]: 
[0m15:12:34.649198 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m15:12:34.651358 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.816064, "process_user_time": 1.693035, "process_kernel_time": 0.229667, "process_mem_max_rss": "143261696", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:12:34.651874 [debug] [MainThread]: Command `dbt run` succeeded at 15:12:34.651767 after 6.82 seconds
[0m15:12:34.652246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728d510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d39f50>]}
[0m15:12:34.652643 [debug] [MainThread]: Flushing usage events
[0m15:14:00.640526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e74f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e75a90>]}


============================== 15:14:00.643183 | 09be0abc-cac5-42eb-80b2-055df0c71542 ==============================
[0m15:14:00.643183 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:14:00.643498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:14:00.802313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e352d0>]}
[0m15:14:00.894740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10756ad50>]}
[0m15:14:00.895473 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:14:00.904363 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:14:00.920485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:00.920730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:00.923693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107810790>]}
[0m15:14:00.929967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107853090>]}
[0m15:14:00.930214 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m15:14:00.930405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104161cd0>]}
[0m15:14:00.931425 [info ] [MainThread]: 
[0m15:14:00.931802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:00.932350 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:14:00.938591 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:14:00.938771 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:14:00.938918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:01.377805 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:14:01.380124 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:14:01.447611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m15:14:01.457861 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:14:01.458232 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m15:14:01.458508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:01.836953 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m15:14:01.840578 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:14:01.904068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106166410>]}
[0m15:14:01.905749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:14:01.906435 [info ] [MainThread]: 
[0m15:14:01.909521 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m15:14:01.910331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m15:14:01.910698 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m15:14:01.917111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m15:14:01.918523 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 15:14:01.910922 => 15:14:01.918335
[0m15:14:01.919260 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m15:14:01.919674 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m15:14:01.920442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m15:14:01.920855 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m15:14:01.922695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m15:14:01.923485 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 15:14:01.921073 => 15:14:01.923326
[0m15:14:01.924169 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m15:14:01.924463 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m15:14:01.925075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m15:14:01.925390 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m15:14:01.926821 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m15:14:01.927589 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 15:14:01.925563 => 15:14:01.927407
[0m15:14:01.928282 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m15:14:01.928591 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m15:14:01.928997 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m15:14:01.929507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m15:14:01.929780 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m15:14:01.933341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:14:01.934399 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 15:14:01.929946 => 15:14:01.934239
[0m15:14:01.934655 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m15:14:01.952458 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:14:01.953591 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m15:14:01.953921 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m15:14:01.954192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:02.649255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:14:02.673955 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 15:14:01.934816 => 15:14:02.673750
[0m15:14:02.674432 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m15:14:02.724826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be4890>]}
[0m15:14:02.725484 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.80s]
[0m15:14:02.726078 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m15:14:02.726493 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m15:14:02.727039 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m15:14:02.727842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m15:14:02.728236 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m15:14:02.736225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m15:14:02.737738 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 15:14:02.728488 => 15:14:02.737484
[0m15:14:02.738094 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m15:14:02.740701 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m15:14:02.742159 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m15:14:02.742505 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m15:14:02.742806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:03.398185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:14:03.403626 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 15:14:02.738274 => 15:14:03.403327
[0m15:14:03.404477 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m15:14:03.462412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c80210>]}
[0m15:14:03.463882 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.73s]
[0m15:14:03.465034 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m15:14:03.465694 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m15:14:03.466513 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m15:14:03.467877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m15:14:03.468526 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m15:14:03.480042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m15:14:03.482432 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 15:14:03.468778 => 15:14:03.482256
[0m15:14:03.482711 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m15:14:03.508107 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:03.508422 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m15:14:03.508666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:03.813821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:14:03.827589 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:03.828146 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:14:03.911911 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:14:03.918325 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:03.919038 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m15:14:03.964569 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:14:03.981153 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:03.981578 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:14:04.026020 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:14:04.028125 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:04.028359 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m15:14:04.070489 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:14:04.082044 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:14:04.094149 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m15:14:04.095056 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:04.095361 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m15:14:04.148134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:14:04.148593 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:04.148970 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m15:14:04.386980 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:14:04.387836 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:04.388284 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m15:14:04.476518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:14:04.484923 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:14:04.488572 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:14:04.488783 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m15:14:04.548042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:14:04.552960 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 15:14:03.482879 => 15:14:04.552642
[0m15:14:04.553573 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m15:14:04.604053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107813150>]}
[0m15:14:04.605098 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.14s]
[0m15:14:04.605888 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m15:14:04.606486 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m15:14:04.607136 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m15:14:04.607990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m15:14:04.608436 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m15:14:04.613127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:14:04.614526 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 15:14:04.608795 => 15:14:04.614242
[0m15:14:04.614920 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m15:14:04.617928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:14:04.619204 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m15:14:04.619555 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (with
l as (
    select * from AIRBNB.DEV.dim_listings_cleansed
),
h as (
    select * from AIRBNB.DEV.dim_hosts_cleansed
)

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at,
from l
left join h 
    on h.host_id = l.host_id
        );
[0m15:14:04.619876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:05.413829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:14:05.417988 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 15:14:04.615192 => 15:14:05.417780
[0m15:14:05.418403 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m15:14:05.478090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09be0abc-cac5-42eb-80b2-055df0c71542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107853a50>]}
[0m15:14:05.479346 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 0.87s]
[0m15:14:05.480033 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m15:14:05.481222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:05.481424 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m15:14:05.481638 [info ] [MainThread]: 
[0m15:14:05.481871 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 4.55 seconds (4.55s).
[0m15:14:05.482452 [debug] [MainThread]: Command end result
[0m15:14:05.489361 [info ] [MainThread]: 
[0m15:14:05.489660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:05.489867 [info ] [MainThread]: 
[0m15:14:05.490073 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:14:05.491849 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.876928, "process_user_time": 1.513035, "process_kernel_time": 0.201047, "process_mem_max_rss": "144310272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:05.492256 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:05.492175 after 4.88 seconds
[0m15:14:05.492538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d35810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e4e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10290df50>]}
[0m15:14:05.492800 [debug] [MainThread]: Flushing usage events
[0m15:16:38.598430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c08dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c098d0>]}


============================== 15:16:38.601770 | b2e5d938-a32c-4ba1-a667-71ea29fb0120 ==============================
[0m15:16:38.601770 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:16:38.602176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:16:38.764348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10931b3d0>]}
[0m15:16:38.797810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f3450>]}
[0m15:16:38.798313 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:16:38.806764 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:16:38.827589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:16:38.827850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:16:38.830953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1d550>]}
[0m15:16:38.837558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e6e90>]}
[0m15:16:38.837778 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m15:16:38.837950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef5cd0>]}
[0m15:16:38.838948 [info ] [MainThread]: 
[0m15:16:38.839318 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:16:38.839859 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:16:38.845933 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:16:38.846119 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:16:38.846252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:39.380997 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:16:39.383727 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:16:39.455131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m15:16:39.465635 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:16:39.466131 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m15:16:39.466485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:39.843514 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:16:39.847894 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:16:39.950220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095d2850>]}
[0m15:16:39.950830 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:39.951030 [info ] [MainThread]: 
[0m15:16:39.952999 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m15:16:39.953385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m15:16:39.953565 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m15:16:39.957013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m15:16:39.957969 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 15:16:39.953683 => 15:16:39.957807
[0m15:16:39.958507 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m15:16:39.958736 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m15:16:39.959220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m15:16:39.959470 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m15:16:39.960520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m15:16:39.960902 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 15:16:39.959636 => 15:16:39.960804
[0m15:16:39.961348 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m15:16:39.961559 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m15:16:39.961955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m15:16:39.962142 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m15:16:39.963139 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m15:16:39.963691 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 15:16:39.962252 => 15:16:39.963591
[0m15:16:39.964208 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m15:16:39.964505 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m15:16:39.964840 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m15:16:39.965215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m15:16:39.965374 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m15:16:39.967995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:16:39.968628 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 15:16:39.965475 => 15:16:39.968511
[0m15:16:39.968827 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m15:16:39.984529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:16:39.985688 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m15:16:39.985941 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
        );
[0m15:16:39.986147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:40.834693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:16:40.860721 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 15:16:39.968935 => 15:16:40.860505
[0m15:16:40.861211 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m15:16:40.909445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099126d0>]}
[0m15:16:40.910214 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m15:16:40.910910 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m15:16:40.911591 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m15:16:40.912165 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m15:16:40.912782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m15:16:40.913093 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m15:16:40.921013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m15:16:40.922635 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 15:16:40.913279 => 15:16:40.922383
[0m15:16:40.922981 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m15:16:40.925652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m15:16:40.927094 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m15:16:40.927395 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
        );
[0m15:16:40.927665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:42.140260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:16:42.145123 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 15:16:40.923167 => 15:16:42.144858
[0m15:16:42.145721 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m15:16:42.202081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d4710>]}
[0m15:16:42.203141 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.29s]
[0m15:16:42.204370 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m15:16:42.205114 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m15:16:42.206191 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m15:16:42.207300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m15:16:42.207754 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m15:16:42.219457 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m15:16:42.221527 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 15:16:42.208025 => 15:16:42.221311
[0m15:16:42.221881 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m15:16:42.247746 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:42.248191 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m15:16:42.248422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:42.608484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:16:42.621154 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:42.621741 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:16:42.691883 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:16:42.698042 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:42.698545 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m15:16:42.744536 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:16:42.760439 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:42.761130 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:16:42.820519 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:16:42.825696 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:42.826228 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m15:16:42.869362 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:16:42.883721 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:16:42.900066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m15:16:42.901253 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:42.901633 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m15:16:42.950179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:16:42.950836 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:42.951211 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m15:16:43.064092 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:16:43.065143 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:43.065718 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m15:16:43.133192 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:16:43.145954 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:16:43.153358 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:16:43.153910 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m15:16:43.237608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:16:43.242166 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 15:16:42.222074 => 15:16:43.241894
[0m15:16:43.242785 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m15:16:43.302123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109614850>]}
[0m15:16:43.303814 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.09s]
[0m15:16:43.304633 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m15:16:43.305377 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m15:16:43.305961 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m15:16:43.306630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m15:16:43.307207 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m15:16:43.310419 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:16:43.311976 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 15:16:43.307522 => 15:16:43.311748
[0m15:16:43.312356 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m15:16:43.314653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:16:43.315749 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m15:16:43.316070 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (with
l as (
    select * from AIRBNB.DEV.dim_listings_cleansed
),
h as (
    select * from AIRBNB.DEV.dim_hosts_cleansed
)

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at,
from l
left join h 
    on h.host_id = l.host_id
        );
[0m15:16:43.316363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:44.341774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:16:44.346095 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 15:16:43.312537 => 15:16:44.345780
[0m15:16:44.346902 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m15:16:44.407239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2e5d938-a32c-4ba1-a667-71ea29fb0120', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096d5a90>]}
[0m15:16:44.408539 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.10s]
[0m15:16:44.409550 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m15:16:44.411774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:44.412178 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m15:16:44.412493 [info ] [MainThread]: 
[0m15:16:44.412774 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m15:16:44.413518 [debug] [MainThread]: Command end result
[0m15:16:44.422954 [info ] [MainThread]: 
[0m15:16:44.423371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:44.423625 [info ] [MainThread]: 
[0m15:16:44.423876 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:16:44.425832 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8572946, "process_user_time": 1.539874, "process_kernel_time": 0.206206, "process_mem_max_rss": "141033472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:16:44.426460 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:44.426340 after 5.86 seconds
[0m15:16:44.426787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046bb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853a190>]}
[0m15:16:44.427097 [debug] [MainThread]: Flushing usage events
[0m15:20:33.586835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209c9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209f6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209fd0d0>]}


============================== 15:20:33.589538 | a55abdd3-19e7-4edf-8ff4-8a4c13bafc33 ==============================
[0m15:20:33.589538 [info ] [MainThread]: Running with dbt=1.7.1
[0m15:20:33.589855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:33.750920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213c4b90>]}
[0m15:20:33.784878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120aab750>]}
[0m15:20:33.785358 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m15:20:33.793855 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m15:20:33.809665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:33.809890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:33.813080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215452d0>]}
[0m15:20:33.819237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1215da710>]}
[0m15:20:33.819467 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m15:20:33.819642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12156f090>]}
[0m15:20:33.820624 [info ] [MainThread]: 
[0m15:20:33.821023 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:20:33.821679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:20:33.827891 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:20:33.828085 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:20:33.828247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:34.353447 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:20:34.355873 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:20:34.423283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m15:20:34.429905 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:20:34.430290 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m15:20:34.430635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:34.660973 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m15:20:34.664521 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:20:34.728307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1213e3210>]}
[0m15:20:34.729452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:20:34.729814 [info ] [MainThread]: 
[0m15:20:34.732350 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m15:20:34.733124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m15:20:34.733500 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m15:20:34.739863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m15:20:34.741308 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 15:20:34.733722 => 15:20:34.741034
[0m15:20:34.742359 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m15:20:34.742836 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m15:20:34.743629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m15:20:34.744013 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m15:20:34.745570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m15:20:34.746602 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 15:20:34.744225 => 15:20:34.746450
[0m15:20:34.747257 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m15:20:34.747552 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m15:20:34.748110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m15:20:34.748357 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m15:20:34.749629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m15:20:34.750250 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 15:20:34.748508 => 15:20:34.750115
[0m15:20:34.750813 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m15:20:34.751090 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m15:20:34.751447 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m15:20:34.751945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m15:20:34.752281 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m15:20:34.756021 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:20:34.756940 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 15:20:34.752455 => 15:20:34.756739
[0m15:20:34.757244 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m15:20:34.771982 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m15:20:34.776104 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m15:20:34.780141 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m15:20:34.780424 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m15:20:34.780624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:35.118133 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:35.129121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m15:20:35.130442 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m15:20:35.130689 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
  );
[0m15:20:35.269482 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:35.287672 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 15:20:34.757405 => 15:20:35.287493
[0m15:20:35.288066 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m15:20:35.348385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e05e90>]}
[0m15:20:35.349057 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.60s]
[0m15:20:35.349585 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m15:20:35.349995 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m15:20:35.350430 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m15:20:35.350996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m15:20:35.351271 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m15:20:35.357317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m15:20:35.359262 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 15:20:35.351429 => 15:20:35.358937
[0m15:20:35.359685 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m15:20:35.362434 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m15:20:35.365261 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m15:20:35.366161 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m15:20:35.366446 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m15:20:35.366709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:35.664024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:35.666785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m15:20:35.668690 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m15:20:35.669145 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
  );
[0m15:20:36.021437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:36.025820 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 15:20:35.359899 => 15:20:36.025672
[0m15:20:36.026118 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m15:20:36.079537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12272f390>]}
[0m15:20:36.080905 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.73s]
[0m15:20:36.081919 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m15:20:36.082597 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m15:20:36.083461 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m15:20:36.084859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m15:20:36.085551 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m15:20:36.095972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m15:20:36.097439 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 15:20:36.085884 => 15:20:36.097202
[0m15:20:36.097855 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m15:20:36.123176 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.123588 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m15:20:36.123860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:36.424224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:36.436958 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.437513 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:20:36.491594 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:20:36.500828 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.501563 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m15:20:36.553004 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:20:36.569328 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.569814 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:20:36.640137 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:20:36.645151 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.645585 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m15:20:36.708889 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m15:20:36.721442 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m15:20:36.737702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m15:20:36.739781 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.740188 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m15:20:36.802361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:36.802992 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.803398 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m15:20:36.926691 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:20:36.927973 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:36.928573 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m15:20:37.032963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:37.043644 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m15:20:37.047899 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m15:20:37.048352 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m15:20:37.110549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:20:37.115028 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 15:20:36.098086 => 15:20:37.114758
[0m15:20:37.115611 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m15:20:37.171659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216c8510>]}
[0m15:20:37.173265 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.09s]
[0m15:20:37.174302 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m15:20:37.174937 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m15:20:37.175623 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m15:20:37.176520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m15:20:37.176928 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m15:20:37.180910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:20:37.183135 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 15:20:37.177160 => 15:20:37.182782
[0m15:20:37.183632 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m15:20:37.202171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m15:20:37.203396 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m15:20:37.203842 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (with
l as (
    select * from AIRBNB.DEV.dim_listings_cleansed
),
h as (
    select * from AIRBNB.DEV.dim_hosts_cleansed
)

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at,
from l
left join h 
    on h.host_id = l.host_id
        );
[0m15:20:37.204221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:20:38.194305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:20:38.202333 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 15:20:37.183843 => 15:20:38.202088
[0m15:20:38.202845 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m15:20:38.261517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55abdd3-19e7-4edf-8ff4-8a4c13bafc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121599bd0>]}
[0m15:20:38.262495 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m15:20:38.263266 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m15:20:38.265585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:38.265925 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was properly closed.
[0m15:20:38.266267 [info ] [MainThread]: 
[0m15:20:38.266856 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m15:20:38.267901 [debug] [MainThread]: Command end result
[0m15:20:38.279417 [info ] [MainThread]: 
[0m15:20:38.279985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:38.280294 [info ] [MainThread]: 
[0m15:20:38.280561 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:20:38.282969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.721878, "process_user_time": 1.574666, "process_kernel_time": 0.212, "process_mem_max_rss": "143654912", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:20:38.283565 [debug] [MainThread]: Command `dbt run` succeeded at 15:20:38.283434 after 4.72 seconds
[0m15:20:38.283902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103033550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209fd590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103019f50>]}
[0m15:20:38.284214 [debug] [MainThread]: Flushing usage events
[0m18:18:36.410074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107513bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075490d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107551550>]}


============================== 18:18:36.412780 | 688ddf35-5289-4e95-a828-eb49ea2d63d1 ==============================
[0m18:18:36.412780 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:18:36.413085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'profiles_dir': '/Users/rachelgao/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:18:36.583398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '688ddf35-5289-4e95-a828-eb49ea2d63d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da6a90>]}
[0m18:18:36.615435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '688ddf35-5289-4e95-a828-eb49ea2d63d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb9d10>]}
[0m18:18:36.615802 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:18:36.624294 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:18:36.649846 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:18:36.650119 [debug] [MainThread]: Partial parsing: added file: dbtlearn://seeds/seed_full_moon_dates.csv
[0m18:18:36.724266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '688ddf35-5289-4e95-a828-eb49ea2d63d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ede90>]}
[0m18:18:36.731319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '688ddf35-5289-4e95-a828-eb49ea2d63d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fe1a50>]}
[0m18:18:36.731535 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m18:18:36.731715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '688ddf35-5289-4e95-a828-eb49ea2d63d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107efb5d0>]}
[0m18:18:36.732526 [info ] [MainThread]: 
[0m18:18:36.732883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:18:36.733371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:18:36.739219 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:18:36.739387 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:18:36.739521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:37.352398 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:18:37.354854 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:18:37.454131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:18:37.465221 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:18:37.465717 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:18:37.466047 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:37.803673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m18:18:37.807230 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:18:37.885316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '688ddf35-5289-4e95-a828-eb49ea2d63d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7c8d0>]}
[0m18:18:37.886682 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:37.887163 [info ] [MainThread]: 
[0m18:18:37.891275 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m18:18:37.891819 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m18:18:37.892582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now seed.dbtlearn.seed_full_moon_dates)
[0m18:18:37.893381 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m18:18:37.893975 [debug] [Thread-1 (]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 18:18:37.893747 => 18:18:37.893752
[0m18:18:37.894347 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m18:18:37.922281 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:18:37.922587 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
create table AIRBNB.DEV.seed_full_moon_dates (full_moon_date date)
[0m18:18:37.922819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:38.578682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:18:38.593392 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:18:38.593835 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
BEGIN
[0m18:18:38.669168 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:18:38.673409 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:18:38.674135 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
insert into AIRBNB.DEV.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m18:18:39.434508 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 1.0 seconds
[0m18:18:39.436048 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:18:39.436670 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
COMMIT
[0m18:18:39.937989 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:18:39.947219 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m18:18:39.967204 [debug] [Thread-1 (]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 18:18:37.894555 => 18:18:39.967017
[0m18:18:39.967522 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m18:18:40.019797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '688ddf35-5289-4e95-a828-eb49ea2d63d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f06810>]}
[0m18:18:40.020526 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file DEV.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 2.13s]
[0m18:18:40.021023 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m18:18:40.022686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:40.023009 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was properly closed.
[0m18:18:40.023267 [info ] [MainThread]: 
[0m18:18:40.023524 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m18:18:40.023975 [debug] [MainThread]: Command end result
[0m18:18:40.031786 [info ] [MainThread]: 
[0m18:18:40.032279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:40.032530 [info ] [MainThread]: 
[0m18:18:40.032795 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:18:40.034782 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.652316, "process_user_time": 1.233177, "process_kernel_time": 0.187837, "process_mem_max_rss": "140132352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:18:40.035275 [debug] [MainThread]: Command `dbt seed` succeeded at 18:18:40.035183 after 3.65 seconds
[0m18:18:40.035574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e96190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ffdf50>]}
[0m18:18:40.035866 [debug] [MainThread]: Flushing usage events
[0m18:25:04.671179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048aae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104858c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d1190>]}


============================== 18:25:04.673990 | 6027af94-cc8a-49e6-bd15-976673bd93bd ==============================
[0m18:25:04.673990 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:25:04.674329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:25:04.832597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105198210>]}
[0m18:25:04.866555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d06d0>]}
[0m18:25:04.867004 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:25:04.876062 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:25:04.928789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:04.929063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:04.932103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534b310>]}
[0m18:25:04.939992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ab990>]}
[0m18:25:04.940213 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m18:25:04.940379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105174b50>]}
[0m18:25:04.941364 [info ] [MainThread]: 
[0m18:25:04.941735 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:25:04.942330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:25:04.948697 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:25:04.948895 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:25:04.949039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:05.521806 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:25:05.524238 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:25:05.574578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:25:05.584070 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:25:05.584489 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:25:05.584811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:05.823788 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:25:05.826825 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:25:05.884208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10519bf90>]}
[0m18:25:05.885346 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:05.885829 [info ] [MainThread]: 
[0m18:25:05.888640 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:25:05.889731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m18:25:05.890171 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:25:05.896943 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:25:05.898468 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 18:25:05.890412 => 18:25:05.898219
[0m18:25:05.899554 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:25:05.900030 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:25:05.900862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:25:05.901241 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:25:05.902994 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:25:05.903802 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 18:25:05.901437 => 18:25:05.903641
[0m18:25:05.904490 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:25:05.904789 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:25:05.905339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:25:05.905725 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:25:05.907287 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:25:05.908199 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 18:25:05.905941 => 18:25:05.907991
[0m18:25:05.908937 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:25:05.909279 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:25:05.909709 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m18:25:05.910236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m18:25:05.910511 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:25:05.914171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:25:05.915023 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 18:25:05.910672 => 18:25:05.914820
[0m18:25:05.915313 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:25:05.935184 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:25:05.941966 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:25:05.942260 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    

with  __dbt__cte__src_hosts as (
with raw_hosts as (
    select * from AIRBNB.RAW.RAW_HOSTS
)

select 
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at,
from raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select 
    host_id,
    ifnull(host_name, 'Anonymous') as host_name,
    is_superhost,
    created_at,
    updated_at,
from src_hosts
  );
[0m18:25:05.942489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:06.327082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:06.351717 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 18:25:05.915451 => 18:25:06.351509
[0m18:25:06.352185 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: Close
[0m18:25:06.396469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b88d0>]}
[0m18:25:06.397310 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.49s]
[0m18:25:06.397873 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:25:06.398283 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:25:06.398791 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m18:25:06.399512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:25:06.399863 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:25:06.406022 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:25:06.407545 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 18:25:06.400061 => 18:25:06.407353
[0m18:25:06.407860 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:25:06.410434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:25:06.412000 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m18:25:06.412320 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    

with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)

select 
    id as listing_id,
    name as listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price as price_str,
    created_at,
    updated_at,
from raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select 
    listing_id,
    listing_name,
    room_type,
    case 
        when minimum_nights = 0 then 1 
        else minimum_nights
    end as minimum_nights,
    host_id,
    replace(price_str, '$') :: number(10, 2) as price,
    created_at,
    updated_at,
from src_listings
  );
[0m18:25:06.412612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:06.679447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:06.685017 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 18:25:06.408033 => 18:25:06.684642
[0m18:25:06.686051 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: Close
[0m18:25:06.764958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564ab90>]}
[0m18:25:06.766402 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.37s]
[0m18:25:06.767332 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:25:06.768185 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:25:06.769317 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m18:25:06.770378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:25:06.770859 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:25:06.782582 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:25:06.785177 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 18:25:06.771139 => 18:25:06.784897
[0m18:25:06.785578 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:25:06.809371 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:06.809695 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
with raw_reviews as (
    select * from AIRBNB.RAW.RAW_REVIEWS
)

select 
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment,
from raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m18:25:06.809948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:07.070642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:07.081893 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.082289 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:25:07.127475 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:25:07.134705 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.135104 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m18:25:07.172286 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:25:07.188579 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.189080 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:25:07.267004 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:25:07.274514 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.275052 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m18:25:07.344961 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m18:25:07.357465 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:25:07.371463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m18:25:07.373244 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.373570 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m18:25:07.476541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:07.477573 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.478307 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m18:25:07.769901 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.0 seconds
[0m18:25:07.771546 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.772175 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m18:25:07.854391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:07.861062 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:25:07.866285 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:25:07.866725 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m18:25:07.953537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:25:07.958267 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 18:25:06.785783 => 18:25:07.957976
[0m18:25:07.958842 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: Close
[0m18:25:08.032821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052422d0>]}
[0m18:25:08.033990 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.26s]
[0m18:25:08.034752 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:25:08.035819 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:25:08.036841 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m18:25:08.037709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m18:25:08.038108 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:25:08.041855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:25:08.044103 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 18:25:08.038336 => 18:25:08.043725
[0m18:25:08.044582 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:25:08.062975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:25:08.064658 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:25:08.065071 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (with
l as (
    select * from AIRBNB.DEV.dim_listings_cleansed
),
h as (
    select * from AIRBNB.DEV.dim_hosts_cleansed
)

select 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    greatest(l.updated_at, h.updated_at) as updated_at,
from l
left join h 
    on h.host_id = l.host_id
        );
[0m18:25:08.065358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:09.089251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:25:09.094020 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 18:25:08.044822 => 18:25:09.093663
[0m18:25:09.094721 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m18:25:09.161277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052dbf90>]}
[0m18:25:09.162686 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.12s]
[0m18:25:09.163950 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:25:09.164765 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:25:09.165569 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_fullmoon_reviews ......................... [RUN]
[0m18:25:09.166620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m18:25:09.167113 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:25:09.171059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:25:09.172000 [debug] [Thread-1 (]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 18:25:09.167401 => 18:25:09.171786
[0m18:25:09.172362 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:25:09.175325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:25:09.176681 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:25:09.177087 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.DEV.mart_fullmoon_reviews
         as
        (

with fct_reviews as (
    select * from AIRBNB.DEV.fct_reviews
),
full_moon_dates as (
    select * from AIRBNB.DEV.seed_full_moon_dates
)

select 
    r.*,
    case 
        when fm.full_moon_date is null then 'not full moon'
        else 'full moon'
    end as is_full_moon,
from fct_reviews as r 
left join full_moon_dates as fm 
    on to_date(r.review_date) = dateadd(day, 1, fm.full_moon_date)
        );
[0m18:25:09.177439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:11.534728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:25:11.539473 [debug] [Thread-1 (]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 18:25:09.172585 => 18:25:11.539171
[0m18:25:11.540131 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:25:11.585136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6027af94-cc8a-49e6-bd15-976673bd93bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105780950>]}
[0m18:25:11.586536 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 2.42s]
[0m18:25:11.587489 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:25:11.590064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:11.590605 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m18:25:11.591078 [info ] [MainThread]: 
[0m18:25:11.591499 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m18:25:11.592603 [debug] [MainThread]: Command end result
[0m18:25:11.601322 [info ] [MainThread]: 
[0m18:25:11.601709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:11.602018 [info ] [MainThread]: 
[0m18:25:11.602618 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:25:11.604756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9599195, "process_user_time": 1.59358, "process_kernel_time": 0.21228, "process_mem_max_rss": "142524416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:25:11.605327 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:11.605211 after 6.96 seconds
[0m18:25:11.605814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100383550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100369f50>]}
[0m18:25:11.606125 [debug] [MainThread]: Flushing usage events
[0m18:31:48.890306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efd0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f21190>]}


============================== 18:31:48.892902 | fb68a057-c20d-4c75-8509-4b8a5bf23d04 ==============================
[0m18:31:48.892902 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:31:48.893200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:31:49.044986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb68a057-c20d-4c75-8509-4b8a5bf23d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdb350>]}
[0m18:31:49.076845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb68a057-c20d-4c75-8509-4b8a5bf23d04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100db910>]}
[0m18:31:49.077213 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:31:49.085442 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:31:49.094049 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbtlearn: src/sources.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version:2 
    2  | 
    3  | sources:
    4  |   - name: airbnb
    5  |     schema: raw
    6  |     tables:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m18:31:49.095571 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 0.23131941, "process_user_time": 0.897003, "process_kernel_time": 0.12944, "process_mem_max_rss": "126697472", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:31:49.095888 [debug] [MainThread]: Command `dbt compile` failed at 18:31:49.095828 after 0.23 seconds
[0m18:31:49.096103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d31fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c63f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bc33d0>]}
[0m18:31:49.096298 [debug] [MainThread]: Flushing usage events
[0m18:34:53.570490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d5c90>]}


============================== 18:34:53.573189 | f132d606-c5e0-44b6-90f6-28925a3bdba6 ==============================
[0m18:34:53.573189 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:34:53.573516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:34:53.736192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f132d606-c5e0-44b6-90f6-28925a3bdba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107922350>]}
[0m18:34:53.768762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f132d606-c5e0-44b6-90f6-28925a3bdba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cb250>]}
[0m18:34:53.769168 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:34:53.777265 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:34:53.801388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:53.801633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:53.804731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f132d606-c5e0-44b6-90f6-28925a3bdba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ea3d0>]}
[0m18:34:53.811274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f132d606-c5e0-44b6-90f6-28925a3bdba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793c250>]}
[0m18:34:53.811532 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m18:34:53.811711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f132d606-c5e0-44b6-90f6-28925a3bdba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b5310>]}
[0m18:34:53.812841 [info ] [MainThread]: 
[0m18:34:53.813271 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:34:53.813914 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m18:34:53.821164 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:34:53.821387 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:34:53.821544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:54.240211 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:34:54.243572 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:34:54.299189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f132d606-c5e0-44b6-90f6-28925a3bdba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107922e90>]}
[0m18:34:54.300285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:54.300722 [info ] [MainThread]: 
[0m18:34:54.303575 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:34:54.304366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m18:34:54.304743 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:34:54.312409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:34:54.313349 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_hosts (compile): 18:34:54.304982 => 18:34:54.313158
[0m18:34:54.314080 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:34:54.314435 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:34:54.315125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:34:54.315431 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:34:54.317761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:34:54.318273 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_listings (compile): 18:34:54.315614 => 18:34:54.318130
[0m18:34:54.318862 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:34:54.319153 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:34:54.319678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:34:54.319933 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:34:54.322016 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:34:54.322755 [debug] [Thread-1 (]: Timing info for model.dbtlearn.src_reviews (compile): 18:34:54.320085 => 18:34:54.322574
[0m18:34:54.323217 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:34:54.323426 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m18:34:54.323797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now seed.dbtlearn.seed_full_moon_dates)
[0m18:34:54.323985 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m18:34:54.324922 [debug] [Thread-1 (]: Timing info for seed.dbtlearn.seed_full_moon_dates (compile): 18:34:54.324094 => 18:34:54.324816
[0m18:34:54.325105 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m18:34:54.325307 [debug] [Thread-1 (]: Timing info for seed.dbtlearn.seed_full_moon_dates (execute): 18:34:54.325212 => 18:34:54.325217
[0m18:34:54.325712 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m18:34:54.325903 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:34:54.326231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearn.seed_full_moon_dates, now model.dbtlearn.dim_hosts_cleansed)
[0m18:34:54.326400 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:34:54.328870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:34:54.329470 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (compile): 18:34:54.326501 => 18:34:54.329343
[0m18:34:54.329677 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:34:54.329894 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_hosts_cleansed (execute): 18:34:54.329798 => 18:34:54.329802
[0m18:34:54.330318 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:34:54.330514 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:34:54.330845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:34:54.331017 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:34:54.334235 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:34:54.334756 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (compile): 18:34:54.331124 => 18:34:54.334635
[0m18:34:54.334975 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:34:54.335222 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_cleansed (execute): 18:34:54.335107 => 18:34:54.335112
[0m18:34:54.335717 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:34:54.335943 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:34:54.336362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:34:54.336562 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:34:54.342761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:34:54.343299 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (compile): 18:34:54.336685 => 18:34:54.343185
[0m18:34:54.343500 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:34:54.343728 [debug] [Thread-1 (]: Timing info for model.dbtlearn.fct_reviews (execute): 18:34:54.343623 => 18:34:54.343626
[0m18:34:54.344199 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:34:54.344430 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:34:54.344816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m18:34:54.345005 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:34:54.347586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:34:54.348313 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (compile): 18:34:54.345123 => 18:34:54.348201
[0m18:34:54.348497 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:34:54.348705 [debug] [Thread-1 (]: Timing info for model.dbtlearn.dim_listings_w_hosts (execute): 18:34:54.348606 => 18:34:54.348609
[0m18:34:54.349141 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:34:54.349339 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:34:54.349673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m18:34:54.349849 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:34:54.351493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:34:54.352186 [debug] [Thread-1 (]: Timing info for model.dbtlearn.mart_fullmoon_reviews (compile): 18:34:54.349955 => 18:34:54.352085
[0m18:34:54.352372 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:34:54.352577 [debug] [Thread-1 (]: Timing info for model.dbtlearn.mart_fullmoon_reviews (execute): 18:34:54.352479 => 18:34:54.352482
[0m18:34:54.352993 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:34:54.353449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:54.353603 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was properly closed.
[0m18:34:54.354132 [debug] [MainThread]: Command end result
[0m18:34:54.361877 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.81748635, "process_user_time": 1.062993, "process_kernel_time": 0.158692, "process_mem_max_rss": "138969088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:34:54.362178 [debug] [MainThread]: Command `dbt compile` succeeded at 18:34:54.362116 after 0.82 seconds
[0m18:34:54.362373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b87550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ae9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795ff50>]}
[0m18:34:54.362575 [debug] [MainThread]: Flushing usage events
[0m18:40:30.222768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f5b10>]}


============================== 18:40:30.225899 | b3fa1c3e-147b-4911-aaab-795fa6128185 ==============================
[0m18:40:30.225899 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:40:30.226235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:30.385562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3fa1c3e-147b-4911-aaab-795fa6128185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d6d50>]}
[0m18:40:30.417819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3fa1c3e-147b-4911-aaab-795fa6128185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738bc50>]}
[0m18:40:30.418196 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:40:30.426780 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:40:30.448816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:40:30.449390 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/sources.yml
[0m18:40:30.567863 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/src/sources.yml @ sources: {'name': 'airbnb', 'schema': 'raw', 'tables': [{'name': 'listings', 'identifier': 'raw_listings'}, {'name': 'hosts', 'identifier': 'raw_hosts'}, {'name': 'reviews', 'identifier': 'raw_reviews', 'loaded_at_field': 'date', 'freshness': {'warn_after': {'count:1': None, 'period': 'hour'}, 'error_after': {'count': 24, 'period': 'hour'}}}]} - at path ['tables'][2]['freshness']: {'warn_after': {'count:1': None, 'period': 'hour'}, 'error_after': {'count': 24, 'period': 'hour'}} is not valid under any of the given schemas
[0m18:40:30.571747 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 0.3769206, "process_user_time": 1.014088, "process_kernel_time": 0.142741, "process_mem_max_rss": "131088384", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:40:30.572061 [debug] [MainThread]: Command `dbt source freshness` failed at 18:40:30.572003 after 0.38 seconds
[0m18:40:30.572252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107394f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d39fd0>]}
[0m18:40:30.572438 [debug] [MainThread]: Flushing usage events
[0m18:40:49.334513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fa8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fd10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120057d0>]}


============================== 18:40:49.337558 | 0f75fbd5-aec9-4b2d-8aa6-73e63aab9789 ==============================
[0m18:40:49.337558 [info ] [MainThread]: Running with dbt=1.7.1
[0m18:40:49.337951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:49.479629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f75fbd5-aec9-4b2d-8aa6-73e63aab9789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9fd90>]}
[0m18:40:49.512015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f75fbd5-aec9-4b2d-8aa6-73e63aab9789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b2890>]}
[0m18:40:49.512474 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:40:49.520976 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m18:40:49.537867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:40:49.538092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:40:49.541205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f75fbd5-aec9-4b2d-8aa6-73e63aab9789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b0f50>]}
[0m18:40:49.547052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f75fbd5-aec9-4b2d-8aa6-73e63aab9789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112940890>]}
[0m18:40:49.547262 [info ] [MainThread]: Found 1 seed, 8 models, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m18:40:49.547442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f75fbd5-aec9-4b2d-8aa6-73e63aab9789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b93190>]}
[0m18:40:49.548346 [info ] [MainThread]: 
[0m18:40:49.548714 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:40:49.549283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m18:40:49.556109 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:40:49.556302 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:40:49.556459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:50.095686 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:40:50.100421 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:40:50.170497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f75fbd5-aec9-4b2d-8aa6-73e63aab9789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e81590>]}
[0m18:40:50.172695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:50.173830 [info ] [MainThread]: 
[0m18:40:50.178146 [debug] [Thread-1 (]: Began running node source.dbtlearn.airbnb.reviews
[0m18:40:50.178789 [info ] [Thread-1 (]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m18:40:50.180019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now source.dbtlearn.airbnb.reviews)
[0m18:40:50.180531 [debug] [Thread-1 (]: Began compiling node source.dbtlearn.airbnb.reviews
[0m18:40:50.182017 [debug] [Thread-1 (]: Timing info for source.dbtlearn.airbnb.reviews (compile): 18:40:50.180999 => 18:40:50.181005
[0m18:40:50.184909 [debug] [Thread-1 (]: Began executing node source.dbtlearn.airbnb.reviews
[0m18:40:50.198105 [debug] [Thread-1 (]: Using snowflake connection "source.dbtlearn.airbnb.reviews"
[0m18:40:50.198500 [debug] [Thread-1 (]: On source.dbtlearn.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "source.dbtlearn.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB.raw.raw_reviews
[0m18:40:50.198976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:50.785956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:40:50.788622 [debug] [Thread-1 (]: On source.dbtlearn.airbnb.reviews: Close
[0m18:40:50.853438 [debug] [Thread-1 (]: Timing info for source.dbtlearn.airbnb.reviews (execute): 18:40:50.187132 => 18:40:50.853255
[0m18:40:50.853984 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of airbnb.reviews ........................................ [[33mWARN[0m in 0.67s]
[0m18:40:50.854280 [debug] [Thread-1 (]: Finished running node source.dbtlearn.airbnb.reviews
[0m18:40:50.854822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:50.855003 [debug] [MainThread]: Connection 'source.dbtlearn.airbnb.reviews' was properly closed.
[0m18:40:50.870165 [info ] [MainThread]: Done.
[0m18:40:50.872460 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 1.5668228, "process_user_time": 1.092964, "process_kernel_time": 0.171256, "process_mem_max_rss": "138657792", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:40:50.873281 [debug] [MainThread]: Command `dbt source freshness` succeeded at 18:40:50.873129 after 1.57 seconds
[0m18:40:50.873789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112005150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112007490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101015ed0>]}
[0m18:40:50.874242 [debug] [MainThread]: Flushing usage events
[0m19:00:00.034746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a8d90>]}


============================== 19:00:00.038034 | 98431d15-b049-4fc1-84a2-63c0e784a430 ==============================
[0m19:00:00.038034 [info ] [MainThread]: Running with dbt=1.7.1
[0m19:00:00.038508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:00.202763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98431d15-b049-4fc1-84a2-63c0e784a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed3f90>]}
[0m19:00:00.235941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98431d15-b049-4fc1-84a2-63c0e784a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105521690>]}
[0m19:00:00.236347 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:00:00.244924 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m19:00:00.271245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:00:00.271596 [debug] [MainThread]: Partial parsing: added file: dbtlearn://snapshots/scd_raw_listings.sql
[0m19:00:00.362993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98431d15-b049-4fc1-84a2-63c0e784a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e8b9d0>]}
[0m19:00:00.371383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98431d15-b049-4fc1-84a2-63c0e784a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073039d0>]}
[0m19:00:00.371629 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m19:00:00.371810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98431d15-b049-4fc1-84a2-63c0e784a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f56c50>]}
[0m19:00:00.372669 [info ] [MainThread]: 
[0m19:00:00.373037 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:00.373525 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:00:00.379352 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:00:00.379534 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:00:00.379677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:01.026249 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:00:01.029576 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:00:01.122229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:00:01.147086 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:00:01.149976 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:00:01.155723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:01.839969 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:00:01.843717 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:00:02.010720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m19:00:02.015858 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:00:02.016397 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:00:02.016761 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:00:02.852971 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m19:00:02.855475 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:00:03.041151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98431d15-b049-4fc1-84a2-63c0e784a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071116d0>]}
[0m19:00:03.043031 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:00:03.043764 [info ] [MainThread]: 
[0m19:00:03.048527 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m19:00:03.054780 [info ] [Thread-1 (]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m19:00:03.056510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now snapshot.dbtlearn.scd_raw_listings)
[0m19:00:03.059643 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m19:00:03.067579 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 19:00:03.060049 => 19:00:03.067299
[0m19:00:03.067966 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m19:00:03.104808 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m19:00:03.106122 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:00:03.106375 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace transient table AIRBNB.dev.scd_raw_listings
         as
        (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select * from AIRBNB.raw.raw_listings

    ) sbq



        );
[0m19:00:03.106603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:00:04.825775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:00:04.852023 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 19:00:03.068167 => 19:00:04.851846
[0m19:00:04.852400 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m19:00:06.335062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98431d15-b049-4fc1-84a2-63c0e784a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739bed0>]}
[0m19:00:06.336961 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 3.28s]
[0m19:00:06.338140 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m19:00:06.340368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:06.340759 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m19:00:06.341103 [info ] [MainThread]: 
[0m19:00:06.341429 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m19:00:06.342053 [debug] [MainThread]: Command end result
[0m19:00:06.353065 [info ] [MainThread]: 
[0m19:00:06.353468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:06.353752 [info ] [MainThread]: 
[0m19:00:06.354026 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:00:06.356347 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 6.35186, "process_user_time": 1.344403, "process_kernel_time": 0.194129, "process_mem_max_rss": "141082624", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:00:06.357047 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:00:06.356938 after 6.35 seconds
[0m19:00:06.357380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d7c810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1006973d0>]}
[0m19:00:06.357700 [debug] [MainThread]: Flushing usage events
[0m19:13:51.400642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095df590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e50d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109604f90>]}


============================== 19:13:51.403482 | 74e36f81-2fa6-4b83-bd17-7d20e971c3b3 ==============================
[0m19:13:51.403482 [info ] [MainThread]: Running with dbt=1.7.1
[0m19:13:51.403793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:51.564550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74e36f81-2fa6-4b83-bd17-7d20e971c3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf7f90>]}
[0m19:13:51.599583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74e36f81-2fa6-4b83-bd17-7d20e971c3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cf6f90>]}
[0m19:13:51.600116 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:13:51.609292 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m19:13:51.635996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:51.636263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:51.639397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74e36f81-2fa6-4b83-bd17-7d20e971c3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ea5890>]}
[0m19:13:51.645983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74e36f81-2fa6-4b83-bd17-7d20e971c3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f211d0>]}
[0m19:13:51.646207 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m19:13:51.646381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e36f81-2fa6-4b83-bd17-7d20e971c3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095df3d0>]}
[0m19:13:51.647305 [info ] [MainThread]: 
[0m19:13:51.647680 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:51.648189 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:13:51.654894 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:13:51.655122 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:13:51.655279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:52.053963 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m19:13:52.056423 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:13:52.129173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m19:13:52.137381 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:13:52.137755 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:13:52.138023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:52.308626 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m19:13:52.312169 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:13:52.373681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m19:13:52.378703 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:13:52.379069 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:13:52.379380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:52.840907 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m19:13:52.843778 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:13:52.907235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e36f81-2fa6-4b83-bd17-7d20e971c3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088ee110>]}
[0m19:13:52.908841 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:52.909585 [info ] [MainThread]: 
[0m19:13:52.913476 [debug] [Thread-1 (]: Began running node snapshot.dbtlearn.scd_raw_listings
[0m19:13:52.914046 [info ] [Thread-1 (]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m19:13:52.914835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtlearn.scd_raw_listings)
[0m19:13:52.915222 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearn.scd_raw_listings
[0m19:13:52.923484 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearn.scd_raw_listings (compile): 19:13:52.915444 => 19:13:52.923269
[0m19:13:52.923847 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearn.scd_raw_listings
[0m19:13:52.958926 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:52.959244 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m19:13:52.959519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:53.127872 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m19:13:53.153847 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:53.154330 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (with snapshot_query as (

        



select * from AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m19:13:54.403331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:13:54.430373 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.432256 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m19:13:54.537783 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m19:13:54.548433 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.549409 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m19:13:54.607591 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m19:13:54.612603 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.613152 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m19:13:54.670590 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m19:13:54.676893 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.677412 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m19:13:54.723979 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m19:13:54.738429 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.738948 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m19:13:54.777907 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m19:13:54.788711 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.790960 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.791604 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
BEGIN
[0m19:13:54.852722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:13:54.853540 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:54.854054 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m19:13:55.585072 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.0 seconds
[0m19:13:55.586954 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearn.scd_raw_listings"
[0m19:13:55.587441 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "snapshot.dbtlearn.scd_raw_listings"} */
COMMIT
[0m19:13:55.747045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:13:55.816836 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearn.scd_raw_listings (execute): 19:13:52.924041 => 19:13:55.814631
[0m19:13:55.819029 [debug] [Thread-1 (]: On snapshot.dbtlearn.scd_raw_listings: Close
[0m19:13:55.910516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e36f81-2fa6-4b83-bd17-7d20e971c3b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cae050>]}
[0m19:13:55.918229 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 2[0m in 2.99s]
[0m19:13:55.918787 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearn.scd_raw_listings
[0m19:13:55.920713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:55.920881 [debug] [MainThread]: Connection 'snapshot.dbtlearn.scd_raw_listings' was properly closed.
[0m19:13:55.921049 [info ] [MainThread]: 
[0m19:13:55.921232 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m19:13:55.921673 [debug] [MainThread]: Command end result
[0m19:13:55.929366 [info ] [MainThread]: 
[0m19:13:55.929576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:55.929710 [info ] [MainThread]: 
[0m19:13:55.929856 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:13:55.932196 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 4.5598216, "process_user_time": 1.371692, "process_kernel_time": 0.224495, "process_mem_max_rss": "137199616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:13:55.932927 [debug] [MainThread]: Command `dbt snapshot` succeeded at 19:13:55.932856 after 4.56 seconds
[0m19:13:55.933182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109606dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109604f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105099f50>]}
[0m19:13:55.933364 [debug] [MainThread]: Flushing usage events
[0m09:34:34.878901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107560a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107560a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c1790>]}


============================== 09:34:34.882915 | 42dd488c-e457-44da-a3ef-dfd70c9b2c1a ==============================
[0m09:34:34.882915 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:34:34.883367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'profiles_dir': '/Users/rachelgao/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:34:35.056516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42dd488c-e457-44da-a3ef-dfd70c9b2c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9ea90>]}
[0m09:34:35.088549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42dd488c-e457-44da-a3ef-dfd70c9b2c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e94490>]}
[0m09:34:35.088932 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:34:35.098631 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:34:35.124862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:34:35.125093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:34:35.128208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42dd488c-e457-44da-a3ef-dfd70c9b2c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f73fd0>]}
[0m09:34:35.134738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42dd488c-e457-44da-a3ef-dfd70c9b2c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa2190>]}
[0m09:34:35.134954 [info ] [MainThread]: Found 8 models, 1 seed, 1 snapshot, 2 tests, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m09:34:35.135202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42dd488c-e457-44da-a3ef-dfd70c9b2c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4fcd0>]}
[0m09:34:35.136240 [info ] [MainThread]: 
[0m09:34:35.136613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:34:35.137209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m09:34:35.144333 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m09:34:35.144538 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m09:34:35.144687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:34:35.749520 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m09:34:35.753043 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m09:34:35.877959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m09:34:35.883262 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m09:34:35.883827 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m09:34:35.884155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:34:36.426703 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m09:34:36.430233 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m09:34:36.514187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42dd488c-e457-44da-a3ef-dfd70c9b2c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5d750>]}
[0m09:34:36.515408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:34:36.515861 [info ] [MainThread]: 
[0m09:34:36.520429 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:34:36.520942 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m09:34:36.521700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m09:34:36.522086 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:34:36.536714 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:34:36.537943 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 09:34:36.522315 => 09:34:36.537686
[0m09:34:36.538327 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:34:36.555330 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:34:36.556248 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:34:36.556496 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m09:34:36.556731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:37.558974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:34:37.572386 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 09:34:36.540932 => 09:34:37.571978
[0m09:34:37.572959 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m09:34:37.623438 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.10s]
[0m09:34:37.624143 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:34:37.624530 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:34:37.625073 [info ] [Thread-1 (]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m09:34:37.625906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m09:34:37.626302 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:34:37.631459 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:34:37.632102 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 09:34:37.626468 => 09:34:37.631946
[0m09:34:37.632342 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:34:37.635444 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:34:37.636442 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:34:37.636732 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:34:37.637012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:34:38.397197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:34:38.401433 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 09:34:37.632478 => 09:34:38.401050
[0m09:34:38.402096 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m09:34:38.452956 [info ] [Thread-1 (]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.83s]
[0m09:34:38.454563 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:34:38.457564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:34:38.458120 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m09:34:38.458584 [info ] [MainThread]: 
[0m09:34:38.459042 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m09:34:38.460290 [debug] [MainThread]: Command end result
[0m09:34:38.470868 [info ] [MainThread]: 
[0m09:34:38.471322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:34:38.471609 [info ] [MainThread]: 
[0m09:34:38.472004 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m09:34:38.511063 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.6780941, "process_user_time": 1.243112, "process_kernel_time": 0.204895, "process_mem_max_rss": "141459456", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:34:38.511776 [debug] [MainThread]: Command `dbt test` succeeded at 09:34:38.511648 after 3.68 seconds
[0m09:34:38.512175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103087550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10306df50>]}
[0m09:34:38.512566 [debug] [MainThread]: Flushing usage events
[0m09:46:36.641289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105207490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527d8d0>]}


============================== 09:46:36.644473 | d50527eb-40a2-4024-8879-853e3b07f107 ==============================
[0m09:46:36.644473 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:46:36.644891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:46:36.813231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd50527eb-40a2-4024-8879-853e3b07f107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105947790>]}
[0m09:46:36.846332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd50527eb-40a2-4024-8879-853e3b07f107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598b3d0>]}
[0m09:46:36.846781 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:46:36.856226 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:46:36.882340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:46:36.882818 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m09:46:37.020861 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test arguments must be a dict, got <class 'list'> (value [{'values': ['Entire home/apt', 'Private room', 'Shared room', 'Hotel room']}])
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m09:46:37.022754 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.41159943, "process_user_time": 1.05783, "process_kernel_time": 0.146173, "process_mem_max_rss": "133562368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:46:37.023112 [debug] [MainThread]: Command `dbt test` failed at 09:46:37.023042 after 0.41 seconds
[0m09:46:37.023336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d2b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105252890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d68f50>]}
[0m09:46:37.023524 [debug] [MainThread]: Flushing usage events
[0m09:51:40.792693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109032e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082c7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108902f50>]}


============================== 09:51:40.795324 | 3272bd60-f30e-4da3-bf25-81ccb3e57c84 ==============================
[0m09:51:40.795324 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:51:40.795750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:51:40.954247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3272bd60-f30e-4da3-bf25-81ccb3e57c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10938a490>]}
[0m09:51:40.986687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3272bd60-f30e-4da3-bf25-81ccb3e57c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974f290>]}
[0m09:51:40.987050 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:51:40.995976 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:51:41.021233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:51:41.021555 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/dim_listings_minimum_nights.sql
[0m09:51:41.021809 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m09:51:41.178368 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test arguments must be a dict, got <class 'list'> (value [{'values': ['Entire home/apt', 'Private room', 'Shared room', 'Hotel room']}])
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m09:51:41.180744 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.41465488, "process_user_time": 1.049481, "process_kernel_time": 0.144343, "process_mem_max_rss": "132415488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:51:41.181063 [debug] [MainThread]: Command `dbt test` failed at 09:51:41.181007 after 0.42 seconds
[0m09:51:41.181253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afae10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb6610>]}
[0m09:51:41.181435 [debug] [MainThread]: Flushing usage events
[0m09:53:04.829161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180206d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180211d0>]}


============================== 09:53:04.831886 | e6fd2c56-678d-4bf6-a03c-86d31587005c ==============================
[0m09:53:04.831886 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:53:04.832194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:53:04.991569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6fd2c56-678d-4bf6-a03c-86d31587005c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107edd190>]}
[0m09:53:05.023792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6fd2c56-678d-4bf6-a03c-86d31587005c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187da8d0>]}
[0m09:53:05.024205 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:53:05.032019 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:53:05.048692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:53:05.049000 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/dim_listings_minimum_nights.sql
[0m09:53:05.049252 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/schema.yml
[0m09:53:05.207403 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test arguments must be a dict, got <class 'list'> (value [{'values': ['Entire home/apt', 'Private room', 'Shared room', 'Hotel room']}])
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m09:53:05.209262 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.4056641, "process_user_time": 1.049204, "process_kernel_time": 0.140704, "process_mem_max_rss": "132202496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:53:05.209594 [debug] [MainThread]: Command `dbt test` failed at 09:53:05.209537 after 0.41 seconds
[0m09:53:05.209791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ce7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118022bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d90d90>]}
[0m09:53:05.209977 [debug] [MainThread]: Flushing usage events
[0m09:54:21.289533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfae050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0209d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0214d0>]}


============================== 09:54:21.292169 | 23275e82-9c3b-49eb-84d0-e71b66da9d9d ==============================
[0m09:54:21.292169 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:54:21.292481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:54:21.458002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23275e82-9c3b-49eb-84d0-e71b66da9d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfdd250>]}
[0m09:54:21.490174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23275e82-9c3b-49eb-84d0-e71b66da9d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eac6d50>]}
[0m09:54:21.490565 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:54:21.498520 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:54:21.515537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:54:21.515741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:54:21.518924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23275e82-9c3b-49eb-84d0-e71b66da9d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea76c90>]}
[0m09:54:21.525760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23275e82-9c3b-49eb-84d0-e71b66da9d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea2d810>]}
[0m09:54:21.525968 [info ] [MainThread]: Found 8 models, 1 seed, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m09:54:21.526140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23275e82-9c3b-49eb-84d0-e71b66da9d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea5bd10>]}
[0m09:54:21.527180 [info ] [MainThread]: 
[0m09:54:21.527549 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:21.528207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m09:54:21.560467 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m09:54:21.560728 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m09:54:21.560885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:22.156063 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m09:54:22.162736 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m09:54:22.295751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m09:54:22.299860 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m09:54:22.300197 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m09:54:22.300394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:22.700612 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m09:54:22.702935 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m09:54:22.762752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23275e82-9c3b-49eb-84d0-e71b66da9d9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cff6250>]}
[0m09:54:22.764170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:22.764784 [info ] [MainThread]: 
[0m09:54:22.768520 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:22.769048 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m09:54:22.769904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m09:54:22.770319 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:22.788705 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:54:22.789869 [debug] [Thread-1 (]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 09:54:22.770557 => 09:54:22.789685
[0m09:54:22.790204 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:22.803990 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:54:22.804947 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:54:22.805225 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m09:54:22.805473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:23.584814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:23.594738 [debug] [Thread-1 (]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 09:54:22.790384 => 09:54:23.594365
[0m09:54:23.595387 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m09:54:23.648907 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.88s]
[0m09:54:23.649744 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:23.650309 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:23.650969 [info ] [Thread-1 (]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m09:54:23.651798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtlearn.dim_listings_minimum_nights)
[0m09:54:23.652189 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:23.655557 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m09:54:23.656588 [debug] [Thread-1 (]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 09:54:23.652442 => 09:54:23.656384
[0m09:54:23.656943 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:23.659554 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m09:54:23.661073 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m09:54:23.661465 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.dim_listings_cleansed
where minimum_nights > 1
limit 10
      
    ) dbt_internal_test
[0m09:54:23.661790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:24.269247 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:24.273586 [debug] [Thread-1 (]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 09:54:23.657119 => 09:54:24.273186
[0m09:54:24.274212 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m09:54:24.324633 [error] [Thread-1 (]: 2 of 6 FAIL 10 dim_listings_minimum_nights ..................................... [[31mFAIL 10[0m in 0.67s]
[0m09:54:24.326085 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:24.326861 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:24.327531 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m09:54:24.328522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m09:54:24.329011 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:24.336578 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:54:24.337491 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 09:54:24.329294 => 09:54:24.337309
[0m09:54:24.337816 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:24.340244 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:54:24.341100 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:54:24.341431 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m09:54:24.341746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:25.053057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:25.057020 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 09:54:24.338004 => 09:54:25.056602
[0m09:54:25.057695 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m09:54:25.106287 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.78s]
[0m09:54:25.107175 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:25.107762 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:25.108408 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m09:54:25.109407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m09:54:25.109888 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:25.115306 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:54:25.117290 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 09:54:25.110174 => 09:54:25.117050
[0m09:54:25.117640 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:25.120122 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:54:25.121042 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:54:25.121369 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m09:54:25.121694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:25.537184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:25.542232 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 09:54:25.117831 => 09:54:25.541719
[0m09:54:25.543067 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m09:54:25.599672 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.49s]
[0m09:54:25.600969 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:25.601606 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:25.602282 [info ] [Thread-1 (]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m09:54:25.603501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m09:54:25.604217 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:25.613554 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:54:25.614415 [debug] [Thread-1 (]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 09:54:25.604558 => 09:54:25.614226
[0m09:54:25.614738 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:25.617619 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:54:25.619001 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:54:25.619449 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:54:25.619808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:26.329078 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:54:26.333714 [debug] [Thread-1 (]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 09:54:25.614921 => 09:54:26.333267
[0m09:54:26.334530 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m09:54:26.382479 [info ] [Thread-1 (]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.78s]
[0m09:54:26.383598 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:26.384215 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:26.385054 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m09:54:26.386100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m09:54:26.386597 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:26.394029 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:54:26.395026 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 09:54:26.386867 => 09:54:26.394808
[0m09:54:26.395402 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:26.397983 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:54:26.399451 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:54:26.399870 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:54:26.400198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:26.581065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:26.584903 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 09:54:26.395611 => 09:54:26.584509
[0m09:54:26.585636 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m09:54:26.637776 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.25s]
[0m09:54:26.639205 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:26.641896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:26.642555 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m09:54:26.643004 [info ] [MainThread]: 
[0m09:54:26.643480 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m09:54:26.644871 [debug] [MainThread]: Command end result
[0m09:54:26.655790 [info ] [MainThread]: 
[0m09:54:26.656226 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:54:26.656503 [info ] [MainThread]: 
[0m09:54:26.656777 [error] [MainThread]: [31mFailure in test dim_listings_minimum_nights (tests/dim_listings_minimum_nights.sql)[0m
[0m09:54:26.657030 [error] [MainThread]:   Got 10 results, configured to fail if != 0
[0m09:54:26.657268 [info ] [MainThread]: 
[0m09:54:26.657505 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearn/tests/dim_listings_minimum_nights.sql
[0m09:54:26.657750 [info ] [MainThread]: 
[0m09:54:26.658016 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:54:26.660569 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 5.3966246, "process_user_time": 1.51727, "process_kernel_time": 0.225556, "process_mem_max_rss": "139427840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:54:26.661160 [debug] [MainThread]: Command `dbt test` failed at 09:54:26.661008 after 5.40 seconds
[0m09:54:26.661540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088dc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489dfd0>]}
[0m09:54:26.661850 [debug] [MainThread]: Flushing usage events
[0m09:54:49.138578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107324cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107326e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737d0d0>]}


============================== 09:54:49.141342 | cfabd287-80a1-4bad-a8db-2c988895a046 ==============================
[0m09:54:49.141342 [info ] [MainThread]: Running with dbt=1.7.1
[0m09:54:49.141642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:54:49.277020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfabd287-80a1-4bad-a8db-2c988895a046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a09c10>]}
[0m09:54:49.311363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfabd287-80a1-4bad-a8db-2c988895a046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a09c10>]}
[0m09:54:49.312151 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:54:49.321225 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m09:54:49.345996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:54:49.346365 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://tests/dim_listings_minimum_nights.sql
[0m09:54:49.416674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfabd287-80a1-4bad-a8db-2c988895a046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f81a50>]}
[0m09:54:49.422562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfabd287-80a1-4bad-a8db-2c988895a046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf3d10>]}
[0m09:54:49.422771 [info ] [MainThread]: Found 8 models, 1 seed, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m09:54:49.422946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfabd287-80a1-4bad-a8db-2c988895a046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104685cd0>]}
[0m09:54:49.423886 [info ] [MainThread]: 
[0m09:54:49.424240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:54:49.424894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m09:54:49.431215 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m09:54:49.431399 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m09:54:49.431535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:54:49.859844 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m09:54:49.862695 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m09:54:49.913526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m09:54:49.918511 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m09:54:49.918927 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m09:54:49.919244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:54:50.484867 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m09:54:50.488825 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m09:54:50.551334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfabd287-80a1-4bad-a8db-2c988895a046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c33d90>]}
[0m09:54:50.553166 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:54:50.553884 [info ] [MainThread]: 
[0m09:54:50.557220 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:50.557720 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m09:54:50.558508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m09:54:50.558913 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:50.575423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:54:50.576322 [debug] [Thread-1 (]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 09:54:50.559150 => 09:54:50.576141
[0m09:54:50.576682 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:50.593157 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:54:50.594169 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m09:54:50.594448 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m09:54:50.594691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:50.821488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:50.830965 [debug] [Thread-1 (]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 09:54:50.576858 => 09:54:50.830602
[0m09:54:50.831590 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m09:54:50.890770 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.33s]
[0m09:54:50.891883 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m09:54:50.892473 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:50.893054 [info ] [Thread-1 (]: 2 of 6 START test dim_listings_minimum_nights .................................. [RUN]
[0m09:54:50.893984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtlearn.dim_listings_minimum_nights)
[0m09:54:50.894400 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:50.897420 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m09:54:50.898508 [debug] [Thread-1 (]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 09:54:50.894606 => 09:54:50.898279
[0m09:54:50.898922 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:50.901835 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m09:54:50.902765 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m09:54:50.903101 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.dim_listings_cleansed
where minimum_nights < 1
limit 10
      
    ) dbt_internal_test
[0m09:54:50.903412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:51.140650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:51.143750 [debug] [Thread-1 (]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 09:54:50.899154 => 09:54:51.143403
[0m09:54:51.144317 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m09:54:51.203580 [info ] [Thread-1 (]: 2 of 6 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.31s]
[0m09:54:51.204957 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m09:54:51.205785 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:51.206503 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m09:54:51.207396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m09:54:51.207832 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:51.216367 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:54:51.217584 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 09:54:51.208077 => 09:54:51.217277
[0m09:54:51.217987 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:51.220472 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:54:51.221296 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m09:54:51.221628 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m09:54:51.221934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:51.456294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:51.460735 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 09:54:51.218206 => 09:54:51.460339
[0m09:54:51.461368 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m09:54:51.555334 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.35s]
[0m09:54:51.556678 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m09:54:51.557391 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:51.558032 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m09:54:51.559138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m09:54:51.559908 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:51.564950 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:54:51.567139 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 09:54:51.560143 => 09:54:51.566901
[0m09:54:51.567523 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:51.570241 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:54:51.571171 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m09:54:51.571525 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m09:54:51.571867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:51.749334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:51.753773 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 09:54:51.567749 => 09:54:51.753397
[0m09:54:51.754527 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m09:54:51.801873 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.24s]
[0m09:54:51.802816 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m09:54:51.803374 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:51.804049 [info ] [Thread-1 (]: 5 of 6 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m09:54:51.805051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m09:54:51.805559 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:51.816237 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:54:51.817103 [debug] [Thread-1 (]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 09:54:51.805858 => 09:54:51.816905
[0m09:54:51.817449 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:51.819931 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:54:51.821008 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m09:54:51.821372 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m09:54:51.821715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:52.074531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:52.078592 [debug] [Thread-1 (]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 09:54:51.817641 => 09:54:52.078175
[0m09:54:52.079294 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m09:54:52.135236 [info ] [Thread-1 (]: 5 of 6 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.33s]
[0m09:54:52.136143 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m09:54:52.136688 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:52.137235 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m09:54:52.138087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m09:54:52.138540 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:52.145608 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:54:52.146545 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 09:54:52.138794 => 09:54:52.146330
[0m09:54:52.146910 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:52.149401 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:54:52.150362 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m09:54:52.150703 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:54:52.151023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:54:52.491535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:54:52.496246 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 09:54:52.147135 => 09:54:52.495840
[0m09:54:52.497202 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m09:54:52.543246 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.41s]
[0m09:54:52.544234 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m09:54:52.546350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:54:52.546811 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m09:54:52.547242 [info ] [MainThread]: 
[0m09:54:52.547599 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m09:54:52.548723 [debug] [MainThread]: Command end result
[0m09:54:52.558616 [info ] [MainThread]: 
[0m09:54:52.559119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:54:52.559395 [info ] [MainThread]: 
[0m09:54:52.559673 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m09:54:52.562353 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.4504714, "process_user_time": 1.498803, "process_kernel_time": 0.198118, "process_mem_max_rss": "145817600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:54:52.562764 [debug] [MainThread]: Command `dbt test` succeeded at 09:54:52.562674 after 3.45 seconds
[0m09:54:52.563078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fb9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e31f50>]}
[0m09:54:52.563394 [debug] [MainThread]: Flushing usage events
[0m13:30:41.020645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b11c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b894d0>]}


============================== 13:30:41.023406 | f575ee33-989a-4ab9-b76a-12832fa06877 ==============================
[0m13:30:41.023406 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:30:41.023722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rachelgao/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rachelgao/Desktop/personal-projects/dbt-course/dbtlearn/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:30:41.192944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f575ee33-989a-4ab9-b76a-12832fa06877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539fb50>]}
[0m13:30:41.225042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f575ee33-989a-4ab9-b76a-12832fa06877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b65350>]}
[0m13:30:41.225418 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:30:41.234524 [debug] [MainThread]: checksum: ad428e6dc3b353dcb23d0c4ebea8b20b180e94b873271ac2a054a8e446dac0e2, vars: {}, profile: , target: , version: 1.7.1
[0m13:30:41.261561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:30:41.261883 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/consistent_created_at.sql
[0m13:30:41.333006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f575ee33-989a-4ab9-b76a-12832fa06877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057802d0>]}
[0m13:30:41.339980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f575ee33-989a-4ab9-b76a-12832fa06877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105565050>]}
[0m13:30:41.340217 [info ] [MainThread]: Found 8 models, 1 seed, 1 snapshot, 7 tests, 3 sources, 0 exposures, 0 metrics, 442 macros, 0 groups, 0 semantic models
[0m13:30:41.340398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f575ee33-989a-4ab9-b76a-12832fa06877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539fbd0>]}
[0m13:30:41.341691 [info ] [MainThread]: 
[0m13:30:41.342118 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:41.342883 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m13:30:41.349484 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:30:41.349676 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:30:41.349813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:41.905071 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:30:41.908595 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:30:42.774694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m13:30:42.780783 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m13:30:42.781383 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m13:30:42.781731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:43.186443 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m13:30:43.188195 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m13:30:43.297110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f575ee33-989a-4ab9-b76a-12832fa06877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542d650>]}
[0m13:30:43.298240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:43.298620 [info ] [MainThread]: 
[0m13:30:43.301792 [debug] [Thread-1 (]: Began running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:43.302317 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m13:30:43.303101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m13:30:43.303824 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:43.319777 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:30:43.321529 [debug] [Thread-1 (]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (compile): 13:30:43.304186 => 13:30:43.321255
[0m13:30:43.321919 [debug] [Thread-1 (]: Began executing node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:43.337237 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:30:43.338042 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m13:30:43.338314 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m13:30:43.338554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:44.124462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:44.136271 [debug] [Thread-1 (]: Timing info for test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af (execute): 13:30:43.322093 => 13:30:44.135937
[0m13:30:44.136880 [debug] [Thread-1 (]: On test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m13:30:44.193840 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.89s]
[0m13:30:44.194658 [debug] [Thread-1 (]: Finished running node test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m13:30:44.195230 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m13:30:44.195868 [info ] [Thread-1 (]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m13:30:44.196929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.dbtlearn.consistent_created_at)
[0m13:30:44.197409 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m13:30:44.201004 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m13:30:44.203158 [debug] [Thread-1 (]: Timing info for test.dbtlearn.consistent_created_at (compile): 13:30:44.197654 => 13:30:44.202919
[0m13:30:44.203553 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m13:30:44.206322 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m13:30:44.207343 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m13:30:44.207699 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.fct_reviews as r 
left join AIRBNB.DEV.dim_listings_cleansed as l 
    on r.listing_id = l.listing_id
where r.review_date <= l.created_at
limit 10
      
    ) dbt_internal_test
[0m13:30:44.208022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:45.621582 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:45.625683 [debug] [Thread-1 (]: Timing info for test.dbtlearn.consistent_created_at (execute): 13:30:44.203774 => 13:30:45.625355
[0m13:30:45.626241 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: Close
[0m13:30:45.732002 [info ] [Thread-1 (]: 2 of 7 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.54s]
[0m13:30:45.733002 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m13:30:45.733562 [debug] [Thread-1 (]: Began running node test.dbtlearn.dim_listings_minimum_nights
[0m13:30:45.734219 [info ] [Thread-1 (]: 3 of 7 START test dim_listings_minimum_nights .................................. [RUN]
[0m13:30:45.735108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.dim_listings_minimum_nights)
[0m13:30:45.735513 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.dim_listings_minimum_nights
[0m13:30:45.738603 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.dim_listings_minimum_nights"
[0m13:30:45.740654 [debug] [Thread-1 (]: Timing info for test.dbtlearn.dim_listings_minimum_nights (compile): 13:30:45.735746 => 13:30:45.740451
[0m13:30:45.741006 [debug] [Thread-1 (]: Began executing node test.dbtlearn.dim_listings_minimum_nights
[0m13:30:45.743928 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.dim_listings_minimum_nights"
[0m13:30:45.744745 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.dim_listings_minimum_nights"
[0m13:30:45.745060 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.dim_listings_minimum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.dim_listings_cleansed
where minimum_nights < 1
limit 10
      
    ) dbt_internal_test
[0m13:30:45.745360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:46.283792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:46.287702 [debug] [Thread-1 (]: Timing info for test.dbtlearn.dim_listings_minimum_nights (execute): 13:30:45.741226 => 13:30:46.287075
[0m13:30:46.288356 [debug] [Thread-1 (]: On test.dbtlearn.dim_listings_minimum_nights: Close
[0m13:30:46.425485 [info ] [Thread-1 (]: 3 of 7 PASS dim_listings_minimum_nights ........................................ [[32mPASS[0m in 0.69s]
[0m13:30:46.426767 [debug] [Thread-1 (]: Finished running node test.dbtlearn.dim_listings_minimum_nights
[0m13:30:46.427495 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:46.428641 [info ] [Thread-1 (]: 4 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m13:30:46.429684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.dim_listings_minimum_nights, now test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m13:30:46.430171 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:46.438112 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:30:46.439130 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (compile): 13:30:46.430462 => 13:30:46.438884
[0m13:30:46.439490 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:46.441939 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:30:46.442785 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m13:30:46.443130 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m13:30:46.443445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:47.114298 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:47.118063 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be (execute): 13:30:46.439674 => 13:30:47.117715
[0m13:30:47.118626 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m13:30:47.183770 [info ] [Thread-1 (]: 4 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.75s]
[0m13:30:47.185083 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be
[0m13:30:47.185757 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:47.186381 [info ] [Thread-1 (]: 5 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:30:47.187546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m13:30:47.188290 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:47.196837 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:30:47.199075 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (compile): 13:30:47.188642 => 13:30:47.198792
[0m13:30:47.199500 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:47.202235 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:30:47.203259 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:30:47.203681 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:30:47.204021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:48.139495 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:48.144185 [debug] [Thread-1 (]: Timing info for test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9 (execute): 13:30:47.199710 => 13:30:48.143793
[0m13:30:48.144973 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m13:30:48.203296 [info ] [Thread-1 (]: 5 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 1.02s]
[0m13:30:48.204497 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:30:48.205186 [debug] [Thread-1 (]: Began running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:48.205936 [info ] [Thread-1 (]: 6 of 7 START test relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [RUN]
[0m13:30:48.207119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad)
[0m13:30:48.208148 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:48.217730 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:30:48.218712 [debug] [Thread-1 (]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (compile): 13:30:48.208462 => 13:30:48.218484
[0m13:30:48.219103 [debug] [Thread-1 (]: Began executing node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:48.221939 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:30:48.223459 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"
[0m13:30:48.223837 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listings_cleansed
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts_cleansed
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:30:48.224184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:48.682217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:30:48.686774 [debug] [Thread-1 (]: Timing info for test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad (execute): 13:30:48.219292 => 13:30:48.686361
[0m13:30:48.687486 [debug] [Thread-1 (]: On test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad: Close
[0m13:30:48.982974 [info ] [Thread-1 (]: 6 of 7 PASS relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_  [[32mPASS[0m in 0.78s]
[0m13:30:48.984789 [debug] [Thread-1 (]: Finished running node test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad
[0m13:30:48.985614 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:48.986214 [info ] [Thread-1 (]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:30:48.987614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m13:30:48.988180 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:48.995147 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:30:48.996158 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (compile): 13:30:48.988437 => 13:30:48.995844
[0m13:30:48.996567 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:48.999500 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:30:49.000815 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:30:49.001211 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.7.1", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:30:49.001567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:50.004543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:50.008815 [debug] [Thread-1 (]: Timing info for test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e (execute): 13:30:48.996769 => 13:30:50.008281
[0m13:30:50.009549 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:30:50.084519 [info ] [Thread-1 (]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.10s]
[0m13:30:50.085711 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:30:50.088716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:50.089338 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m13:30:50.089790 [info ] [MainThread]: 
[0m13:30:50.090204 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 8.75 seconds (8.75s).
[0m13:30:50.091654 [debug] [MainThread]: Command end result
[0m13:30:50.104282 [info ] [MainThread]: 
[0m13:30:50.104668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:50.104944 [info ] [MainThread]: 
[0m13:30:50.105204 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:30:50.177304 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.188802, "process_user_time": 1.578226, "process_kernel_time": 0.232349, "process_mem_max_rss": "139821056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:30:50.177745 [debug] [MainThread]: Command `dbt test` succeeded at 13:30:50.177667 after 9.19 seconds
[0m13:30:50.177994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059715d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442b290>]}
[0m13:30:50.178257 [debug] [MainThread]: Flushing usage events
[0m13:41:49.508304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107006f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070079d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297a50>]}


============================== 13:41:49.510856 | f03385ab-4fa2-418a-9b23-83caa728b4bd ==============================
[0m13:41:49.510856 [info ] [MainThread]: Running with dbt=1.7.1
[0m13:41:49.511188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/Users/rachelgao/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:41:49.511542 [info ] [MainThread]: dbt version: 1.7.1
[0m13:41:49.512015 [info ] [MainThread]: python version: 3.11.10
[0m13:41:49.512212 [info ] [MainThread]: python path: /Users/rachelgao/Desktop/personal-projects/dbt-course/venv/bin/python
[0m13:41:49.512346 [info ] [MainThread]: os info: macOS-13.2.1-arm64-arm-64bit
[0m13:41:49.629686 [info ] [MainThread]: Using profiles dir at /Users/rachelgao/.dbt
[0m13:41:49.629950 [info ] [MainThread]: Using profiles.yml file at /Users/rachelgao/.dbt/profiles.yml
[0m13:41:49.630113 [info ] [MainThread]: Using dbt_project.yml file at /Users/rachelgao/Desktop/personal-projects/dbt-course/dbt_project.yml
[0m13:41:49.630384 [info ] [MainThread]: adapter type: snowflake
[0m13:41:49.630564 [info ] [MainThread]: adapter version: 1.7.1
[0m13:41:49.630717 [info ] [MainThread]: Configuration:
[0m13:41:49.630853 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:41:49.630979 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m13:41:49.631101 [info ] [MainThread]: Required dependencies:
[0m13:41:49.631248 [debug] [MainThread]: Executing "git --help"
[0m13:41:49.641567 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:41:49.642057 [debug] [MainThread]: STDERR: "b''"
[0m13:41:49.642229 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:41:49.642378 [info ] [MainThread]: Connection:
[0m13:41:49.642558 [info ] [MainThread]:   account: ubnyzrz-kb52270
[0m13:41:49.642684 [info ] [MainThread]:   user: dbt
[0m13:41:49.642810 [info ] [MainThread]:   database: AIRBNB
[0m13:41:49.642927 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m13:41:49.643044 [info ] [MainThread]:   role: transform
[0m13:41:49.643159 [info ] [MainThread]:   schema: DEV
[0m13:41:49.643274 [info ] [MainThread]:   authenticator: None
[0m13:41:49.643391 [info ] [MainThread]:   private_key_path: None
[0m13:41:49.643507 [info ] [MainThread]:   token: None
[0m13:41:49.643620 [info ] [MainThread]:   oauth_client_id: None
[0m13:41:49.643743 [info ] [MainThread]:   query_tag: None
[0m13:41:49.643868 [info ] [MainThread]:   client_session_keep_alive: False
[0m13:41:49.643981 [info ] [MainThread]:   host: None
[0m13:41:49.644107 [info ] [MainThread]:   port: None
[0m13:41:49.644219 [info ] [MainThread]:   proxy_host: None
[0m13:41:49.644331 [info ] [MainThread]:   proxy_port: None
[0m13:41:49.644440 [info ] [MainThread]:   protocol: None
[0m13:41:49.644550 [info ] [MainThread]:   connect_retries: 1
[0m13:41:49.644661 [info ] [MainThread]:   connect_timeout: None
[0m13:41:49.644775 [info ] [MainThread]:   retry_on_database_errors: False
[0m13:41:49.644886 [info ] [MainThread]:   retry_all: False
[0m13:41:49.645000 [info ] [MainThread]:   insecure_mode: False
[0m13:41:49.645111 [info ] [MainThread]:   reuse_connections: None
[0m13:41:49.645329 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:41:49.648367 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m13:41:49.649269 [debug] [MainThread]: Using snowflake connection "debug"
[0m13:41:49.649456 [debug] [MainThread]: On debug: select 1 as id
[0m13:41:49.649610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:50.090312 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:41:50.092939 [debug] [MainThread]: On debug: Close
[0m13:41:50.157487 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:41:50.158253 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:41:50.158671 [info ] [MainThread]: Project loading failed for the following reason:
 project path </Users/rachelgao/Desktop/personal-projects/dbt-course/dbt_project.yml> not found

[0m13:41:50.162561 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.6812986, "process_user_time": 0.876479, "process_kernel_time": 0.137211, "process_mem_max_rss": "130744320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:41:50.163419 [debug] [MainThread]: Command `dbt debug` failed at 13:41:50.163276 after 0.68 seconds
[0m13:41:50.163828 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:41:50.164232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107006f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b84d90>]}
[0m13:41:50.164644 [debug] [MainThread]: Flushing usage events
